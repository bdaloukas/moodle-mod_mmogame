define("mmogametype_quiz/mmogametypequizalone",["mmogametype_quiz/mmogametypequiz"],(function(MmoGameTypeQuiz){return class extends MmoGameTypeQuiz{player;constructor(){super(),this.cIcons=this.hasHelp()?5:4,this.type="alone"}createIconBar(){let i=0;const step=this.iconSize+this.padding,nicknameHeight=Math.round(this.iconSize/3),fragment=document.createDocumentFragment(),[nickname,avatar]=this.createNicknameAvatar(fragment,"mmogame-quiz-alone",Math.round(this.padding+i++*step),this.padding,2*this.iconSize+this.padding,nicknameHeight,this.padding+nicknameHeight,this.iconSize);if(this.player=this.createDivScorePercent(fragment,"mmogame-quiz-alone",this.padding+i++*step,this.padding+nicknameHeight,this.getContrastingColor(this.color),!0),this.player.avatarElement=avatar,this.player.nicknameElement=nickname,this.player.cacheAvatar="",this.player.cacheNickname="",this.player.lblScore.title=this.getStringM("js_grade"),this.player.lblRank.title=this.getStringM("js_ranking_grade"),this.createButtonSound(fragment,this.padding+i++*step,this.padding+nicknameHeight,this.iconSize),this.hasHelp()){this.createButtonHelp(fragment,this.padding+i++*step,this.padding).addEventListener("click",(()=>this.onClickHelp()))}this.createArea(2*this.padding+this.iconSize+nicknameHeight),this.body.appendChild(fragment)}processSetAnswer(json){this.correct=json.correct,this.playAudio(0!==json.iscorrect?this.audioYes:this.audioNo),void 0!==json.correct&&"multichoice"===this.qtype&&this.updateScreenAfterAnswerMultichoice(),this.disableInput();const btn=super.createImageButton(this.area,"mmogame-quiz-next",this.nextLeft,this.nextTop,0,this.iconSize,"assets/next.svg");btn.addEventListener("click",(()=>{this.callGetAttempt(),this.area.removeChild(btn)})),this.showScore(json)}onServerFastJson(response){const[state,timefastjson]=response.split("-").map(Number);timefastjson===this.timefastjson&&state===this.state?this.sendFastJSON():this.callGetAttempt()}createScreen(json,disabled){if(this.endofgame)return this.createDivMessage("mmogame-endofgame",this.getStringM("js_game_over")),void this.showScore(json);this.isVertical?this.createScreenVertical(json,disabled):this.createScreenHorizontal(json,disabled),this.showScore(json)}createScreenHorizontal(json,disabled){let maxHeight=this.areaRect.height-2*this.padding-this.iconSize;const width=Math.round((this.areaRect.width-this.padding)/2-this.padding);for(let step=1;step<=2;step++){let defSize;if(this.fontSize=this.findbest(1===step?this.minFontSize:this.minFontSize/2,this.maxFontSize,(fontSize=>{if(defSize=this.createDefinition(0,0,width-this.padding,0,!0,fontSize,json.definition),defSize[0]>=width)return 1;let ansSize=this.createAnswer(0,0,width-this.padding,!0,fontSize,disabled);return ansSize[0]>=width?1:defSize[1]<maxHeight&&ansSize[1]<maxHeight?-1:1})),defSize[0]<=width&&defSize[1]<=maxHeight)break}this.radioSize=Math.round(this.fontSize);const heightAnswer=this.createAnswer(width,0,width-this.padding,!1,this.fontSize,disabled);this.createDefinition(0,0,width-this.padding,heightAnswer,!1,this.fontSize,json.definition),this.nextTop=heightAnswer+this.padding,this.stripLeft=width+this.padding,this.stripWidth=2*this.iconSize,this.stripHeight=this.iconSize}createScreenVertical(json,disabled){let maxHeight=this.areaRect.height-2*this.padding-this.iconSize;for(let step=1;step<=2;step++){let defSize,ansSize;if(this.fontSize=this.findbest(1===step?this.minFontSize:this.minFontSize/2,this.maxFontSize,(fontSize=>(defSize=this.createDefinition(0,0,this.areaRect.width,0,!0,fontSize,json.definition),ansSize=this.createAnswer(0,0,this.areaRect.width,!0,fontSize,disabled),defSize[0]>=this.areaRect.width||ansSize[0]>=this.areaRect.width?1:defSize[1]+ansSize[1]<maxHeight?-1:1))),defSize[0]<=this.areaRect.width&&defSize[1]+ansSize[1]<=maxHeight)break}this.radioSize=Math.round(this.fontSize);const defSize=this.createDefinition(0,0,this.areaRect.width,0,!1,this.fontSize,json.definition);this.nextTop=this.createAnswer(0,defSize[1]+this.padding,this.areaRect.width,!1,this.fontSize,disabled)+this.padding,this.stripLeft=this.iconSize+this.padding,this.stripWidth=2*this.iconSize,this.stripHeight=this.iconSize}processGetAttempt(json){if(this.computeDifClock(json.time,json.timestart,json.timeclose),0===parseInt(json.state))return json.qtype="",json.colors&&(this.setColorsString(json.colors),this.createIconBar()),this.showScore(json),void this.createDivMessageStart(this.getStringM("js_wait_to_start"));if(void 0===this.player&&(this.setColorsString(json.colors),this.createIconBar()),json.name&&(document.title=json.name),json.errorcode)return void this.createDivMessage("mmogame-error",json.errorcode);this.state=parseInt(json.state,10),this.fastjson=json.fastjson,this.timefastjson=parseInt(json.timefastjson,10);const nicknameWidth=2*this.iconSize+this.padding,nicknameHeight=this.iconSize/3;this.updateNicknameAvatar(this.player,json.avatar,json.nickname,nicknameWidth,nicknameHeight),this.attempt=json.attempt,this.qtype=json.qtype,"multichoice"===this.qtype&&(this.answers=[],this.answersID=json.answerids,json.answers.forEach(((answer,index)=>{this.answers[index]=this.repairP(answer)}))),this.answer=json.answer??void 0,this.endofgame=void 0!==json.endofgame&&0!==json.endofgame,json.definition=this.repairP(json.definition),this.errorcode=json.errorcode,0!==json.state&&this.createScreen(json,!1),this.sendFastJSON()}showScore(_ref){let{sumscore:sumscore,rank:rank,percent:percent,percentrank:percentrank}=_ref;super.showScore(this.player,sumscore,rank,percent,percentrank,!0)}showHelpScreen(div){div.innerHTML=`\n                <br>\n                <div>${this.getStringT("js_alone_help")}</div><br>\n\n                <table class="mmogame-table-help">\n                    <tr>\n                        <td><img height="83" src="assets/aduel/example2.png" alt="" /></td>\n                        <td>${this.getStringT("js_aduel_example2")}</td>\n                    </tr>\n                </table>\n            `}}}));

//# sourceMappingURL=mmogametypequizalone.min.js.map