{"version":3,"file":"mmoquizatypeduel.min.js","sources":["../src/mmoquizatypeduel.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport mmoGameTypeQuiz from 'mmogametypequiz';\nexport default class extends mmoGameTypeQuiz {\n    constructor() {\n        super();\n        this.cIcons = 8;\n        this.hasBasBottom = false;\n        if (window.innerWidth < window.innerHeight) {\n            this.cIcons -= 3;\n            this.hasBasBottom = true;\n        } else {\n             this.cIcons += (this.hasHelp() ? 1 : 0);\n        }\n        this.isWaitOponent = false;\n        this.timeoutMSEC = 2000; // Wait Oponent.\n        this.autosubmit = true;\n        this.type = 'aduel';\n    }\n\n    createIconBar() {\n        let i = 0;\n\n        this.removeBodyChilds();\n\n        let copyrightHeight = 0;\n        this.nickNameHeight = Math.round(this.iconSize / 3);\n\n        this.areaTop = 2 * this.padding + this.iconSize + this.nickNameHeight;\n        this.areaLeft = this.padding;\n        this.areaWidth = Math.round(window.innerWidth - 2 * this.padding);\n        this.areaHeight = Math.round(window.innerHeight - this.areaTop - copyrightHeight);\n        if (this.hasBasBottom) {\n            this.areaHeight -= this.iconSize + 2 * this.padding;\n        }\n\n        this.buttonAvatarLeft = this.padding + i * (this.iconSize + this.padding);\n        this.buttonAvatarHeight = this.iconSize + this.nickNameHeight;\n        this.buttonAvatarTop = this.nickNameHeight + this.iconSize - this.buttonAvatarHeight + this.padding;\n        this.createButtonsAvatar(1, Math.round(this.padding + (i++) * (this.iconSize + this.padding)),\n            2 * this.iconSize + this.padding, this.nickNameHeight);\n        this.buttonsAvatar[1].style.top = (this.padding + this.nickNameHeight) + \"px\";\n\n        this.createDivScorePercent(this.padding + (i++) * (this.iconSize + this.padding), this.padding + this.nickNameHeight, 1,\n            true);\n\n        this.createButtonsAvatar(2, Math.round(this.padding + (i++) * (this.iconSize + this.padding)),\n            2 * this.iconSize + this.padding, this.nickNameHeight);\n        this.buttonsAvatar[2].style.top = (this.padding + this.nickNameHeight) + \"px\";\n\n        this.createDivScore(Math.round(this.padding + (i++) * (this.iconSize + this.padding)), this.padding + this.nickNameHeight,\n            2, true);\n        this.buttonScore2.style.visibility = \"hidden\";\n\n        this.createDivTimer(this.padding + (i++) * (this.iconSize + this.padding), this.padding + this.nickNameHeight,\n            this.iconSize);\n        if (this.hasBasBottom === false) {\n            this.createButtonSound(this.padding + (i++) * (this.iconSize + this.padding), this.padding + this.nickNameHeight);\n        } else {\n            this.createButtonSound(this.padding, this.areaTop + this.areaHeight);\n        }\n        let instance = this;\n\n        if (this.hasBasBottom === false) {\n            this.buttonHighScore = this.createImageButton(this.body, this.padding + i * (this.iconSize + this.padding),\n                this.padding + this.nickNameHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/highscore.svg');\n\n            this.button5050 = this.createImageButton(this.body, this.padding + (i++) * (this.iconSize + this.padding),\n                this.padding + this.nickNameHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/cutred.svg');\n        } else {\n            this.buttonHighScore = this.createImageButton(this.body, this.padding + (this.iconSize + this.padding),\n                this.areaTop + this.areaHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/highscore.svg');\n\n            this.button5050 = this.createImageButton(this.body, this.padding + (this.iconSize + this.padding),\n                this.areaTop + this.areaHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/cutred.svg');\n        }\n        this.buttonHighScore.style.visibility = 'hidden';\n        this.buttonHighScore.addEventListener(\"click\", function() {\n            instance.sendGetHighScore();\n        });\n        this.button5050.addEventListener(\"click\", function() {\n            instance.sendGetAttempt(false, \"tool1\");\n        });\n        this.button5050.title = '[LANG_HELP_5050]';\n\n        let left;\n        if (this.hasBasBottom === false) {\n            left = this.padding + (i++) * (this.iconSize + this.padding);\n            this.buttonSkip = this.createImageButton(this.body, left, this.padding + this.nickNameHeight, this.iconSize,\n                this.iconSize, \"mmogame_button_red\", 'assets/skip.svg');\n        } else {\n            this.buttonSkip = this.createImageButton(this.body, this.padding + 2 * (this.iconSize + this.padding),\n                this.areaTop + this.areaHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/skip.svg');\n        }\n        this.buttonSkip.addEventListener(\"click\", function() {\n            instance.sendAnswer(true, \"tool2\");\n        });\n        this.buttonSkip.title = '[LANG_HELP_SKIP]';\n\n        if (this.hasBasBottom === false) {\n            this.buttonWizard = this.createImageButton(this.body, left, this.padding + this.nickNameHeight, this.iconSize,\n                this.iconSize, \"mmogame_button_red\", 'assets/wizard.svg');\n        } else {\n            this.buttonWizard = this.createImageButton(this.body, this.padding + 2 * (this.iconSize + this.padding),\n                this.areaTop + this.areaHeight, this.iconSize, this.iconSize, \"mmogame_button_red\", 'assets/wizard.svg');\n        }\n        this.buttonWizard.addEventListener(\"click\", function() {\n            instance.sendGetAttempt(false, \"tool3\");\n        });\n        this.buttonWizard.style.visibility = 'hidden';\n        this.buttonWizard.title = '[LANG_WIZARD]';\n\n        if (this.hasHelp()) {\n            if (this.hasBasBottom === false) {\n                this.createButtonHelp(this.padding + (i++) * (this.iconSize + this.padding), this.padding + this.nickNameHeight);\n            } else {\n                this.createButtonHelp(this.padding + 3 * (this.iconSize + this.padding), this.areaTop + this.areaHeight);\n            }\n            this.buttonHelp.addEventListener(\"click\", function() {\n                instance.onClickHelp(instance.buttonHelp);\n             });\n        }\n\n        this.createDivColor(this.body, 0, window.innerHeight - copyrightHeight - 1, window.innerWidth - 1, copyrightHeight,\n            this.getColorGray(this.colorScore2));\n        this.vertical = this.areaHeight > this.areaWidth;\n    }\n\n    updateButtonTool(btn, tool) {\n        btn.style.visibility = tool !== undefined && tool !== 0 ? \"hidden\" : \"visible\";\n    }\n\n    onServerGetAttempt(json, param) {\n        if (this.buttonHighScore !== undefined) {\n            this.buttonHighScore.style.visibility = 'hidden';\n        }\n        this.computeDifClock(json);\n        this.timefastjson = json.timefastjson;\n        this.fastjson = json.fastjson;\n\n        if (json.name !== undefined) {\n            window.document.title = json.name;\n        }\n\n        if (json.helpurl !== undefined) {\n            this.helpUrl = json.helpurl;\n        }\n\n        this.correct = undefined;\n        if (json.state === 0) {\n            json.qtype = '';\n            super.onServerGetAttempt(json, param);\n            this.showScore(json);\n            this.onServerGetAttemptHideButtons();\n            this.createDivMessageStart('[LANGM_WAIT_TO_START]');\n            return;\n        }\n\n        this.state = parseInt(json.state);\n\n        // Need for a change on colors.\n        if (this.savedColors === undefined || this.savedColors !== json.colors) {\n            this.savedColors = json.colors;\n            this.colors = undefined;\n        }\n\n        if (this.colors === undefined) {\n            this.setColorsString(json.colors);\n            this.createIconBar();\n        }\n\n        this.updateButtonsAvatar(1, json.avatar, json.nickname);\n        this.updateButtonsAvatar(2, json.aduelAvatar, json.aduelNickname);\n\n        this.updateButtonTool(this.button5050, json.tool1numattempt);\n        if (json.tool3 !== undefined) {\n            json.tool2numattempt = -1;\n        } else {\n            json.tool3numattempt = -1;\n        }\n        this.updateButtonTool(this.buttonSkip, json.tool2numattempt);\n        this.updateButtonTool(this.buttonWizard, json.tool3numattempt);\n\n        if (param === undefined) {\n            param = false;\n        }\n\n        this.attempt = json.attempt;\n        this.aduelPlayer = json.aduelPlayer;\n        this.aduelScore = json.aduelScore;\n        this.aduelRank = json.aduelRank;\n\n        if (json.errorcode !== undefined && json.errorcode === 'aduel_no_rivals' || json.attempt === 0) {\n            if (param === false) {\n                this.waitOponent();\n            }\n            this.hideTools();\n            this.showScore(json);\n            this.onServerGetAttemptRetry();\n            return;\n        }\n\n        this.isWaitOponent = false;\n\n        this.qtype = json.qtype;\n        if (json.qtype === 'multichoice') {\n            this.answers = [];\n            this.answersID = [];\n            for (let i = 1; i <= json.answers; i++) {\n                this.answersID.push(json[\"answerid_\" + i]);\n                this.answers.push(this.repairP(json[\"answer_\" + i]));\n            }\n        }\n        this.answer = json.answer !== undefined ? json.answer : null;\n        this.definition = this.repairP(json.definition);\n        if (json.aduelAttempt !== undefined) {\n            this.definition = json.aduelAttempt + \". \" + this.definition;\n        }\n        this.single = json.single;\n        this.autosave = json.autosave !== 0;\n        this.errorcode = json.errorcode;\n\n        this.readJsonFiles(json);\n        this.createScreen(json, false);\n        if (this.btnSubmit !== undefined) {\n            this.btnSubmit.style.visibility = \"hidden\";\n        }\n\n        this.updateLabelTimer();\n        this.sendFastJSON();\n    }\n\n    onServerGetAttemptRetry() {\n        let instance = this;\n        this.timeout = setTimeout(function() {\n            instance.sendGetAttempt(true);\n        }, this.timeoutMSEC);\n    }\n\n    onServerGetAttemptHideButtons() {\n        this.button5050.style.visibility = 'hidden';\n        this.buttonSkip.style.visibility = 'hidden';\n        if (this.btnSubmit !== undefined) {\n            this.btnSubmit.style.visibility = \"hidden\";\n        }\n        this.buttonsAvatar[2].style.visibility = 'hidden';\n    }\n\n    onTimeout() {\n        this.labelTimer.innerHTML = '';\n        this.disableInput();\n        if (this.btnSubmit !== undefined) {\n            this.btnSubmit.style.display = 'none';\n        }\n\n        this.answer = '';\n        this.sendAnswer(true);\n\n        let btn = super.createImageButton(this.area, this.nextLeft, this.nextTop, 0, this.iconSize, \"\", 'assets/next.svg', false,\n            'alt');\n        btn.title = '[LANG_NEXT_QUESTION]';\n        let instance = this;\n        btn.addEventListener(\"click\", function() {\n            instance.sendGetAttempt(false);\n            instance.area.removeChild(btn);\n        });\n    }\n\n    waitOponent() {\n        if (this.isWaitOponent) {\n            return;\n        }\n        this.updateButtonsAvatar(2, \"\", \"\");\n        this.createDivMessage('[LANG_WAIT_OPONENT]');\n        if (this.labelTimer !== undefined) {\n            this.labelTimer.innerHTML = \"\";\n        }\n    }\n\n    hideTools() {\n        this.updateButtonTool(this.button5050, -1);\n        this.updateButtonTool(this.buttonSkip, -1);\n        this.updateButtonTool(this.buttonWizard, -1);\n    }\n\n    onServerAnswer(json) {\n        if (json.submit === 0) {\n            return;\n        }\n\n        this.correct = json.correct;\n\n        if (json.correct !== undefined) {\n            if (this.qtype === \"multichoice\") {\n                this.onServerAnswerMultichoice(json);\n            }\n        }\n\n        this.disableInput();\n        this.buttonHighScore.style.visibility = 'visible';\n\n        this.isWaitOponent = false;\n        if (this.aItemAnswer !== undefined && json.correct !== undefined) {\n            for (let i = 0; i < this.aItemAnswer.length; i++) {\n                this.aItemAnswer[i].classList.add(\"disabled\");\n            }\n        }\n        if (this.divShortAnswer !== undefined) {\n            this.divShortAnswer.disabled = true;\n        }\n        if (this.btnSubmit !== undefined) {\n            this.body.removeChild(this.btnSubmit);\n            this.btnSubmit = undefined;\n        }\n\n        this.showCorrectAnswer(json);\n\n        let btn = super.createImageButton(this.area, this.nextLeft, this.nextTop, 0, this.iconSize, \"\", 'assets/next.svg', false,\n            'alt');\n        btn.title = '[LANG_NEXT_QUESTION]';\n        let instance = this;\n        btn.addEventListener(\"click\", function() {\n            instance.sendGetAttempt(false);\n            instance.area.removeChild(btn);\n        });\n\n        this.showScore(json);\n\n        this.timeclose = 0;\n\n        if (this.aduelPlayer === 1) {\n            if (json.attempt === 0) {\n                this.timeclose = 0;\n                this.waitOponent();\n            }\n\n            this.showScore(json);\n        }\n\n        if (this.button5050 !== undefined) {\n            this.button5050.style.visibility = 'hidden';\n            this.buttonSkip.style.visibility = 'hidden';\n        }\n    }\n\n    sendAnswer(submit, subcommand) {\n        if (this.correct === undefined) {\n            super.sendAnswer(submit, subcommand);\n        }\n    }\n\n    onServerAnswerMultichoice(json) {\n        let foundCorrect = false;\n\n        let aduelAnswers = json.aduelPlayer === 2 && json.aduel_useranswer !== null ? json.aduel_useranswer.split(\",\") : '';\n        let aCorrect = json.correct.split(\",\");\n        for (let i = 0; i < this.answersID.length; i++) {\n            if (this.answersID[i] === '') {\n                continue;\n            }\n\n            let label = this.aItemLabel[i];\n\n            let iscorrect1, iscorrect2;\n\n            let iscorrect = aCorrect.includes(this.answersID[i]);\n\n            if (this.aItemAnswer[i].classList.contains(\"checked\")) {\n                iscorrect1 = aCorrect.includes(this.answersID[i]);\n            }\n            if (iscorrect1) {\n                foundCorrect = true;\n            }\n\n            if (aduelAnswers.includes(this.answersID[i])) {\n                iscorrect2 = aCorrect.includes(this.answersID[i]);\n            }\n\n            if (iscorrect === false && iscorrect1 === undefined && iscorrect2 === undefined) {\n                continue;\n            }\n\n            let width = this.labelWidth;\n            let height = this.aItemLabel[i].scrollHeight;\n\n            let move = (iscorrect2 !== undefined ? 2 : 1) * this.radioSize;\n            if (iscorrect1 === undefined && iscorrect2 === undefined) {\n                move = 0;\n            }\n            width -= move;\n\n            if (move !== 0) {\n                label.style.left = (parseInt(label.style.left) + move) + \"px\";\n            }\n            this.aItemLabel[i].style.width = width + \"px\";\n            this.autoResizeText(this.aItemLabel[i], width, height, true, this.minFontSize, this.maxFontSize, 0.5);\n\n            this.onServerAnswerMultichoiceShowCorrect(i, iscorrect1, iscorrect2);\n        }\n\n        this.playAudio(foundCorrect ? this.audioYes : this.audioNo);\n    }\n\n    onServerAnswerMultichoiceShowCorrect(i, iscorrect1, iscorrect2, iscorrect) {\n        if (iscorrect) {\n            this.aItemLabel[i].innerHTML = '<b><u>' + this.aItemLabel[i].innerHTML + '</b></u>';\n        }\n\n        if (iscorrect1 !== undefined) {\n            let t = parseInt(this.aItemAnswer[i].style.top);\n            let div = this.createDiv(this.area, this.aItemCorrectX[i], t, this.radioSize, this.radioSize);\n            div.title = iscorrect1 ? '[LANG_CORRECT_ANSWER]' : '[LANG_WRONG_ANSWER]';\n            div.innerHTML = this.getSVGcorrect(this.radioSize, iscorrect1, this.colorScore, this.colorScore);\n        }\n\n        if (iscorrect2 !== undefined) {\n            let t = parseInt(this.aItemAnswer[i].style.top);\n            let div = this.createDiv(this.area, this.aItemCorrectX[i] + this.radioSize, t, this.radioSize, this.radioSize);\n            div.innerHTML = this.getSVGcorrect(this.radioSize, iscorrect2, this.colorScore2, this.colorScore2);\n            div.title = iscorrect2 ? '[LANG_CORRECT_ANSWER]' : '[LANG_WRONG_ANSWER]';\n        }\n    }\n\n    showCorrectAnswer(json) {\n        this.timeclose = 0;\n        this.updateLabelTimer();\n\n        this.strip = this.createDiv(this.area, this.stripLeft, this.nextTop, this.stripWidth, this.stripHeight);\n\n        if (json.tool2 === undefined || this.aduelPlayer === 2) {\n            this.createImage(this.area, this.stripLeft, this.nextTop, this.buttonsAvatar[1].width,\n            this.buttonsAvatar[1].height, this.buttonsAvatar[1].src);\n        }\n        if (this.aduelPlayer === 2 && json.tool2 === undefined) {\n            this.createImage(this.area, this.stripLeft + this.iconSize, this.nextTop, this.buttonsAvatar[2].width,\n                this.buttonsAvatar[2].height, this.buttonsAvatar[2].src);\n        }\n\n        this.strip.style.top = this.nextTop + \"px\";\n        let s = this.getSVGcorrect(this.iconSize, json.iscorrect !== 0, this.colorScore, this.colorScore);\n        if (json.tool2 !== undefined && this.aduelPlayer === 1) {\n            s = '';\n        }\n        if (this.aduelPlayer === 2 && json.tool2 === undefined) {\n            s += this.getSVGcorrect(this.iconSize, json.aduel_iscorrect !== 0, this.colorScore2, this.colorScore2);\n        }\n        this.strip.innerHTML = s;\n\n        this.strip.style.zIndex = '1';\n    }\n\n    showScore(json) {\n        let rank = json.rank;\n        let rankc = json.completedrank;\n        if (rank !== undefined && rankc !== undefined) {\n            if (parseInt(rank) < parseInt(rankc)) {\n                json.completedrank = '';\n                json.rank = '# ' + rank;\n            } else {\n                json.rank = '';\n                json.completedrank = '# ' + rankc;\n            }\n        }\n\n        if (json.aduelPlayer === 2) {\n            super.showScore(json);\n        } else {\n            let s = json.sumscore;\n            json.sumscore = this.labelScore.innerHTML;\n            super.showScore(json);\n            json.sumscore = s;\n            s = json.sumscore === undefined ? '' : '<b>' + json.sumscore + '</b>';\n            if (this.labelScore.innerHTML !== s) {\n                this.labelScore.innerHTML = s;\n                this.autoResizeText(this.labelScore, 0.8 * this.iconSize / 2, this.iconSize / 2, false, 0, 0, 1);\n            }\n        }\n\n        if (json.aduelPlayer === 1 || json.aduelPlayer === undefined) {\n            this.labelScore2.style.visibility = \"hidden\";\n            this.labelScoreRank2.style.visibility = \"hidden\";\n            this.buttonScore2.style.visibility = \"hidden\";\n            this.labelAddScore2.style.visibility = \"hidden\";\n        } else {\n            this.labelScore2.style.visibility = \"visible\";\n            this.labelScoreRank2.style.visibility = \"visible\";\n            this.buttonScore2.style.visibility = \"visible\";\n            this.labelAddScore2.style.visibility = \"visible\";\n\n            let rank = json.aduelRank;\n            let score = json.aduelScore;\n\n            if (json.aduelRank !== undefined && json.aduel_completedrank !== undefined) {\n                let rank1 = parseInt(json.aduelRank);\n                let rank2 = parseInt(json.aduel_completedrank);\n                if (rank1 <= rank2) {\n                    rank = '#' + rank1;\n                    score = json.aduelScore;\n                    this.labelScore2.title = '[LANG_GRADE]';\n                    this.labelScoreRank2.title = \"[LANG_POSITION_GRADE]\";\n                } else {\n                    rank = '#' + rank2;\n                    score = Math.round(100 * json.aduel_completedrank) + \"%\";\n                    this.labelScore2.title = \"[LANG_PERCENT_OPONENT]\";\n                    this.labelScoreRank2.title = \"[LANG_POSITION_PERCENT]\";\n                }\n            }\n            let s = '<b>' + score + '</b>';\n            if (this.labelScore2.innerHTML !== s) {\n                this.labelScore2.innerHTML = s;\n                this.autoResizeText(this.labelScore2, this.iconSize - 2 * this.padding, this.iconSize / 2, false, 0, 0, 1);\n            }\n            this.labelScoreRank2.innerHTML = rank;\n            this.labelScoreRank2.style.lineHeight = (this.iconSize / 3) + \"px\";\n            this.autoResizeText(this.labelScoreRank2, 0.5 * this.iconSize, this.iconSize / 3, true, 0, 0, 1);\n\n            this.labelAddScore2.innerHTML = json.aduel_addscore === undefined ? '' : json.aduel_addscore;\n            this.autoResizeText(this.labelAddScore2, this.iconSize, this.iconSize / 3, true, 0, 0, 1);\n        }\n\n        json.rank = rank;\n        json.completedrank = rankc;\n    }\n\n    onServerFastJson(response) {\n        if (response === '') {\n            this.sendFastJSON();\n            return;\n        }\n\n        let a = response.split('-'); // Are state,timefastjson.\n        let newstate = a.length > 0 ? parseInt(a[0]) : 0;\n        let newTimeFastJSON = a.length > 1 ? a[1] : 0;\n\n        if (this.timefastjson === null) {\n            this.timefastjson = 0;\n        }\n\n        if (newstate !== this.state || newTimeFastJSON !== this.timefastjson) {\n            this.sendGetAttempt();\n            return;\n        }\n\n        this.sendFastJSON();\n    }\n\n    sendGetHighScore() {\n        let xmlhttp = new XMLHttpRequest();\n        let instance = this;\n        xmlhttp.onreadystatechange = () => {\n                    if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {\n                        let json = JSON.parse(xmlhttp.responseText);\n                        instance.createScreenHighScore(json);\n                    }\n                };\n\n        xmlhttp.open(\"POST\", this.url, true);\n        xmlhttp.setRequestHeader(\"Content-Type\", \"application/json\");\n        let data = JSON.stringify({\"command\": \"gethighscore\", \"mmogameid\": this.mmogameid, \"pin\": this.pin,\n            'kinduser': this.kinduser, \"user\": this.auserid, \"count\": 10});\n        xmlhttp.send(data);\n    }\n\n    createScreenHighScore(json) {\n        if (this.highScore !== undefined) {\n            this.body.removeChild(this.highScore);\n            this.highScore = undefined;\n            this.strip.style.visibility = 'visible';\n            this.strip.style.zIndex = '1';\n            return;\n        }\n\n        this.removeDivMessage();\n\n        if (this.vertical) {\n            this.createScreenVerticalHighScore(json);\n        } else {\n            this.createScreenHorizontalHighScore(json);\n        }\n    }\n\n    createScreenHorizontalHighScore(json) {\n        this.createScreenVerticalHighScore(json);\n    }\n\n    createScreenVerticalHighScore(json) {\n        if (json.count === 0) {\n            return;\n        }\n\n        if (this.strip !== undefined) {\n            this.strip.style.visibility = 'hidden';\n        }\n\n        this.highScore = this.createDivColor(this.body, this.areaLeft, this.areaTop, this.areaWidth - this.padding,\n            this.areaHeight - this.padding, this.getColorHex(this.colorBackground));\n\n        let canvas = document.createElement('canvas');\n        canvas.style.left = '0px';\n        canvas.style.top = \"0px\";\n        canvas.width = this.areaWidth;\n        canvas.height = this.areaHeight;\n        canvas.style.zIndex = 8;\n        canvas.style.position = \"absolute\";\n\n        this.highScore.appendChild(canvas);\n\n        let ctx = canvas.getContext(\"2d\");\n        let fontSize = this.minFontSize;\n        ctx.font = fontSize + \"px sans-serif\";\n\n        this.drawHighScore1(json, ctx, fontSize);\n    }\n\n    drawHighScore1(json, ctx, fontSize) {\n        ctx.textAlign = \"center\";\n        let text1 = ctx.measureText(\"[LANG_RANKING_ORDER]\");\n        let width1 = text1.width;\n        let text = ctx.measureText(\"[LANG_GRADE]\");\n        let width2 = text.width;\n\n        let col1 = 0;\n        let col2 = col1 + width1 + this.padding;\n        let col3 = col2 + width2 + this.padding;\n        let row = Math.round(3 * fontSize * 1.2);\n\n        let results = JSON.parse(json.results);\n\n        ctx.fillStyle = this.getColorContrast(this.colorBackground);\n\n        let y = Math.round(fontSize * 1.2);\n        ctx.textAlign = \"center\";\n        ctx.fillText(\"[LANG_RANKING_ORDER]\", col1 + width1 / 2, y);\n\n        ctx.fillText(\"[LANG_GRADE]\", col2 + width2 / 2, y);\n\n        ctx.textAlign = \"left\";\n        ctx.fillText(\"[LANGM_NAME]\", col3, y);\n\n        results.forEach(player => {\n            y += row / 2 + this.padding;\n\n            ctx.textAlign = \"center\";\n            ctx.fillText(player.rank, col1 + width1 / 2, y);\n\n            ctx.fillText(player.score, col2 + width2 / 2, y);\n\n            ctx.textAlign = \"left\";\n            ctx.fillText(player.name, col3 + row - this.padding, y);\n\n            this.createImage(this.highScore, col3, y - row / 2, row - this.padding, row - this.padding,\n                'assets/avatars/' + player.avatar);\n\n            y += row / 2 - this.padding;\n        });\n    }\n\n    showHelpScreen(div) {\n        div.innerHTML = `\n<div>[LANG_ADUEL_HELP]</div>\n\n<table border=1>\n    <tr>\n        <td><center>\n            <img height=\"90\" src=\"../../../../assets/cutred.svg\" alt=\"\" />\n        </td>\n        <td>[LANG_ADUEL_CUT]</td>\n        <td><center>\n            <img height=\"90\" src=\"../../../../assets/skip.svg\" alt=\"\" />\n        </td>\n        <td>[LANG_ADUEL_SKIP]</td>\n        <td><center>\n            <img height=\"90\" src=\"../../../../assets/wizard.svg\" alt=\"\" />\n        </td>\n        <td>[LANG_ADUEL_WIZARD]</td>\n    </tr>\n\n    <tr>\n        <td><center>\n            <img height=\"90\" src=\"../../assets/aduel/example1.png\" alt=\"\" />\n        </td><center>\n\n        <td>` + this.getStringG( 'js_aduel_example1') + `</td>\n        <td><center>\n            <img height=\"83\" src=\"../../assets/aduel/example2.png\" alt=\"\" />\n        </td>\n\n        <td>\\` + this.getStringG( 'js_aduel_example2') + \\`</td>\n    </tr>\n</table>        \n        `;\n    }\n}\n"],"names":["mmoGameTypeQuiz","constructor","cIcons","hasBasBottom","window","innerWidth","innerHeight","this","hasHelp","isWaitOponent","timeoutMSEC","autosubmit","type","createIconBar","i","removeBodyChilds","nickNameHeight","Math","round","iconSize","areaTop","padding","areaLeft","areaWidth","areaHeight","buttonAvatarLeft","buttonAvatarHeight","buttonAvatarTop","createButtonsAvatar","buttonsAvatar","style","top","createDivScorePercent","createDivScore","buttonScore2","visibility","createDivTimer","createButtonSound","left","instance","buttonHighScore","createImageButton","body","button5050","addEventListener","sendGetHighScore","sendGetAttempt","title","buttonSkip","sendAnswer","buttonWizard","createButtonHelp","buttonHelp","onClickHelp","createDivColor","getColorGray","colorScore2","vertical","updateButtonTool","btn","tool","undefined","onServerGetAttempt","json","param","computeDifClock","timefastjson","fastjson","name","document","helpurl","helpUrl","correct","state","qtype","showScore","onServerGetAttemptHideButtons","createDivMessageStart","parseInt","savedColors","colors","setColorsString","updateButtonsAvatar","avatar","nickname","aduelAvatar","aduelNickname","tool1numattempt","tool3","tool2numattempt","tool3numattempt","attempt","aduelPlayer","aduelScore","aduelRank","errorcode","waitOponent","hideTools","onServerGetAttemptRetry","answers","answersID","push","repairP","answer","definition","aduelAttempt","single","autosave","readJsonFiles","createScreen","btnSubmit","updateLabelTimer","sendFastJSON","timeout","setTimeout","onTimeout","labelTimer","innerHTML","disableInput","display","super","area","nextLeft","nextTop","removeChild","createDivMessage","onServerAnswer","submit","onServerAnswerMultichoice","aItemAnswer","length","classList","add","divShortAnswer","disabled","showCorrectAnswer","timeclose","subcommand","foundCorrect","aduelAnswers","aduel_useranswer","split","aCorrect","iscorrect1","iscorrect2","label","aItemLabel","iscorrect","includes","contains","width","labelWidth","height","scrollHeight","move","radioSize","autoResizeText","minFontSize","maxFontSize","onServerAnswerMultichoiceShowCorrect","playAudio","audioYes","audioNo","t","div","createDiv","aItemCorrectX","getSVGcorrect","colorScore","strip","stripLeft","stripWidth","stripHeight","tool2","createImage","src","s","aduel_iscorrect","zIndex","rank","rankc","completedrank","sumscore","labelScore","labelScore2","labelScoreRank2","labelAddScore2","score","aduel_completedrank","rank1","rank2","lineHeight","aduel_addscore","onServerFastJson","response","a","newstate","newTimeFastJSON","xmlhttp","XMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","createScreenHighScore","open","url","setRequestHeader","data","stringify","mmogameid","pin","kinduser","auserid","send","highScore","removeDivMessage","createScreenVerticalHighScore","createScreenHorizontalHighScore","count","getColorHex","colorBackground","canvas","createElement","position","appendChild","ctx","getContext","fontSize","font","drawHighScore1","textAlign","width1","measureText","width2","col2","col3","row","results","fillStyle","getColorContrast","y","fillText","forEach","player","showHelpScreen","getStringG"],"mappings":"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"}