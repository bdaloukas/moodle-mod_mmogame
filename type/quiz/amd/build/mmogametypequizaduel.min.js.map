{"version":3,"file":"mmogametypequizaduel.min.js","sources":["../src/mmogametypequizaduel.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine(['mmogametype_quiz/mmogametypequiz'],\n    function(MmoGameTypeQuiz) {\n        return class MmoGameTypeQuizAduel extends MmoGameTypeQuiz {\n\n    player1; // Stores all info for player1\n    player2; // Stores all info for player2\n    isWaitOpponent; // True if wait someone to answer a set of questions.\n\n    // Timer variables.\n    divTimer;\n    timerTimeout;\n\n    stripLeft; // Left position of next button.\n    stripTop; // Top position of next button.\n\n    timeoutWaitOpponent = 5000;\n\n    // Tools button\n    buttonHighScore;\n    button5050;\n    buttonSkip;\n    buttonWizard;\n    buttonHelp;\n\n    constructor() {\n        super('aduel');\n\n        // Initialize core properties\n        this.cIcons = (this.isVertical ? 5 : 8) + (this.hasHelp() ? 1 : 0);\n\n        this.isWaitOpponent = false;\n    }\n\n    createIconBar() {\n        let i = 0;\n        const step = this.iconSize + this.padding;\n\n        const nicknameHeight = Math.round(this.iconSize / 3);\n        const fragment = document.createDocumentFragment(); // Batch DOM updates\n\n        let nickname, avatar;\n        [nickname, avatar] = this.createNicknameAvatar(fragment, 'mmogame-quiz-aduel',\n            Math.round(this.padding + (i++) * step),\n            this.padding,\n            2 * this.iconSize + this.padding,\n            nicknameHeight,\n            this.padding + nicknameHeight,\n            this.iconSize);\n\n        this.player1 = this.createDivScorePercent(fragment, 'mmogame-quiz-aduel-player1',\n            this.padding + (i++) * (this.iconSize + this.padding), this.padding + nicknameHeight,\n            true, this.colorScore);\n        this.player1.avatarElement = avatar;\n        this.player1.nicknameElement = nickname;\n        this.player1.cacheAvatar = '';\n        this.player1.cacheNickname = '';\n        this.player1.lblScore.title = this.getStringM('js_grade');\n        this.player1.lblRank.title = this.getStringM('js_position_grade');\n\n        [nickname, avatar] = this.createNicknameAvatar(fragment, 'mmogame-quiz-alone',\n            Math.round(this.padding + (i++) * step),\n            this.padding,\n            2 * this.iconSize + this.padding,\n            nicknameHeight,\n            this.padding + nicknameHeight,\n            this.iconSize);\n\n        this.player2 = this.createDivScorePercent(fragment, 'mmogame-quiz-aduel-player2',\n            this.padding + (i++) * (this.iconSize + this.padding), this.padding + nicknameHeight,\n            false, this.colorScore2);\n        this.player2.avatarElement = avatar;\n        this.player2.nicknameElement = nickname;\n        this.player2.cacheAvatar = '';\n        this.player2.cacheNickname = '';\n        this.player2.lblScore.title = this.getStringM('js_percent_opponent');\n        this.player2.lblRank.title = this.getStringM('js_position_percent');\n\n        this.createArea(2 * this.padding + this.iconSize + nicknameHeight, this.isVertical ? this.iconSize : 0);\n\n        this.createDivTimer(this.body, this.padding + (i++) * (this.iconSize + this.padding), this.padding + nicknameHeight,\n            this.iconSize);\n\n        if (this.isVertical) {\n            i = 0;\n            this.createButtonSound(fragment,\n                this.padding + (i++) * (this.iconSize + this.padding), this.areaRect.top + this.areaRect.height);\n        } else {\n            this.createButtonSound(fragment, this.padding + (i++) * (this.iconSize + this.padding), this.padding + nicknameHeight);\n        }\n        // High score button and Cut tool are in the same position.\n        let leftButton;\n        if (this.isVertical) {\n            leftButton = this.padding + (this.iconSize + this.padding);\n            this.buttonHighScore = this.createImageButton(fragment, 'mmogame-quiz-highscore',\n                leftButton, this.areaRect.top + this.areaRect.height,\n                this.iconSize, this.iconSize, 'assets/highscore.svg');\n\n            this.button5050 = this.createImageButton(fragment, 'mmogame-quiz-aduel-5050',\n                leftButton, this.areaRect.top + this.areaRect.height, this.iconSize, this.iconSize,\n                'assets/cutred.svg');\n        } else {\n            leftButton = this.padding + (i++) * (this.iconSize + this.padding);\n\n            this.buttonHighScore = this.createImageButton(fragment, 'mmogame-quiz-highscore',\n                leftButton, this.padding + nicknameHeight, this.iconSize, this.iconSize,\n                'assets/highscore.svg');\n\n            this.button5050 = this.createImageButton(fragment, 'mmogame-quiz-aduel-5050',\n                leftButton, this.padding + nicknameHeight, this.iconSize, this.iconSize,\n                'assets/cutred.svg');\n        }\n        this.buttonHighScore.style.visibility = 'hidden';\n        this.buttonHighScore.addEventListener(\"click\", () => {\n            this.sendGetHighScore();\n        });\n        this.button5050.addEventListener(\"click\", () => {\n            this.callGetAttempt({subcommand: 'tool1'});\n        });\n        this.button5050.title = this.getStringT('js_help_5050');\n\n        leftButton += this.iconSize + this.padding;\n\n        // Skip and wizard tools are in the same position.\n        if (this.isVertical) {\n            this.buttonSkip = this.createImageButton(fragment, 'mmogame-quiz-aduel-skip',\n                leftButton, this.areaRect.top + this.areaRect.height, this.iconSize, this.iconSize,\n                'assets/skip.svg');\n        } else {\n            this.buttonSkip = this.createImageButton(fragment, 'mmogame-quiz-aduel-skip',\n                leftButton, this.padding + nicknameHeight, this.iconSize,\n                this.iconSize, 'assets/skip.svg');\n        }\n        this.buttonSkip.addEventListener(\"click\", () => {\n            this.callSetAnswer(\"tool2\");\n        });\n        this.buttonSkip.title = this.getStringT('js_help_skip');\n\n        if (this.isVertical) {\n            this.buttonWizard = this.createImageButton(fragment, 'mmogame-quiz-aduel-wizard',\n                leftButton, this.areaRect.top + this.areaRect.height, this.iconSize, this.iconSize,\n                'assets/wizard.svg');\n        } else {\n            this.buttonWizard = this.createImageButton(fragment, 'mmogame-quiz-aduel-wizard',\n                leftButton, this.padding + nicknameHeight, this.iconSize,\n                this.iconSize, 'assets/wizard.svg');\n        }\n        this.buttonWizard.addEventListener(\"click\", () => {\n            this.callGetAttempt({'subcommand': 'tool3'});\n        });\n        this.buttonWizard.style.visibility = 'hidden';\n        this.buttonWizard.title = this.getStringT('js_wizard');\n\n        if (this.hasHelp()) {\n            if (this.isVertical) {\n                this.buttonHelp = this.createButtonHelp(fragment,\n                    leftButton + this.iconSize + this.padding, this.areaRect.top + this.areaRect.height);\n            } else {\n                this.buttonHelp = this.createButtonHelp(fragment,\n                    leftButton + this.iconSize + this.padding, this.padding + nicknameHeight);\n            }\n            this.buttonHelp.addEventListener(\"click\", () => this.onClickHelp());\n        }\n\n        this.body.appendChild(fragment); // Batch insert into DOM\n    }\n\n    updateButtonTool(btn, tool) {\n        btn.style.visibility = tool !== undefined && parseInt(tool) !== 0 ? \"visible\" : \"hidden\";\n    }\n\n    processGetAttempt(json) {\n        super.processGetAttempt(json);\n        if (this.buttonHighScore !== undefined) {\n            this.buttonHighScore.style.visibility = 'hidden';\n        }\n\n        if (json.name !== undefined) {\n            window.document.title = json.name;\n        }\n        this.correct = undefined;\n\n        // Update game state\n        this.state = parseInt(json.state);\n\n        const nicknameWidth = 2 * this.iconSize + this.padding;\n        const nicknameHeight = Math.round(this.iconSize / 3);\n        if (this.state === 0) {\n            json.qtype = '';\n            if (this.button5050 === undefined) {\n                this.setColorsString(json.colors);\n                this.createIconBar();\n            }\n            this.hideTools();\n            this.updateNicknameAvatar(this.player1, json.avatar, json.nickname, nicknameWidth, nicknameHeight);\n            this.showScore(json);\n\n            this.createDivMessageStart(this.getStringM('js_wait_to_start'));\n            this.sendFastJSON(); // Send fast JSON updates\n            if (this.buttonHelp !== undefined) {\n                this.buttonHelp.style.visibility = 'hidden';\n            }\n            return;\n        }\n\n        this.computeTimeStartClose(json.timestart, json.timeclose);\n\n        // Need for a change on colors.\n        if (this.savedColors === undefined || this.savedColors !== json.colors) {\n            this.savedColors = json.colors;\n            this.colors = undefined;\n        }\n        // Update the window title if a name is provided\n        if (json.name) {\n            document.title = json.name;\n        }\n        if (this.player1 === undefined) {\n            this.setColorsString(json.colors);\n            this.createIconBar();\n        }\n\n        if (this.area === undefined) {\n            this.createArea(this.areaRect.top, this.areaRect.bottom);\n        }\n\n        this.updateNicknameAvatar(this.player1, json.avatar, json.nickname, nicknameWidth, nicknameHeight);\n        this.updateNicknameAvatar(this.player2, json.aduelAvatar, json.aduelNickname, nicknameWidth, nicknameHeight);\n\n        this.updateButtonTool(this.button5050, json.tool1);\n        if (json.tool3 !== undefined) {\n            json.tool2numattempt = -1;\n        } else {\n            json.tool3numattempt = -1;\n        }\n        this.updateButtonTool(this.buttonSkip, json.tool2);\n        this.updateButtonTool(this.buttonWizard, json.tool3);\n\n        this.attempt = json.attempt;\n        this.aduelPlayer = json.aduelPlayer;\n        this.aduelScore = json.aduelScore;\n        this.aduelRank = json.aduelRank;\n\n        if (json.errorcode !== undefined && json.errorcode === 'aduel_no_rivals' || json.attempt === 0) {\n            if (json.param === undefined) {\n                this.showWaitOpponent();\n            }\n            this.hideTools();\n            this.showScore(json);\n            this.timeout = setTimeout(() => {\n                this.callGetAttempt();\n            }, this.timeoutWaitOpponent);\n            return;\n        }\n\n        this.isWaitOpponent = false;\n\n        this.qtype = json.qtype;\n        if (json.qtype === 'multichoice') {\n            this.answers = [];\n            this.answersID = json.answerids;\n\n            json.answers.forEach((answer, index) => {\n                this.answers[index] = this.repairP(answer);\n            });\n        }\n        this.answer = json.answer !== undefined ? json.answer : null;\n        this.definition = this.repairP(json.definition);\n        if (json.aduelAttempt !== undefined) {\n            this.definition = json.aduelAttempt + \". \" + this.definition;\n        }\n        this.single = json.single;\n        this.errorcode = json.errorcode;\n\n        this.createScreen(json, false);\n        this.updateDivTimer();\n        this.sendFastJSON();\n\n        if (this.buttonHelp !== undefined) {\n            this.buttonHelp.style.visibility = 'visible';\n        }\n    }\n\n    onTimeout() {\n        this.divTimer.innerHTML = '';\n        this.disableInput();\n\n        this.answer = '';\n        this.answerid = 0;\n        this.callSetAnswer();\n\n        this.createNextButton(this.areaRect.width - this.iconSize - this.padding, this.stripTop);\n    }\n\n    waitOpponent() {\n        if (this.isWaitOpponent) {\n            return;\n        }\n        this.updateNicknameAvatar(this.player2, \"\", \"\");\n        this.createDivMessage('mmomgame-quiz-aduel-wait-opponent',\n            this.getStringT('js_aduel_wait_opponent'));\n        if (this.labelTimer !== undefined) {\n            this.labelTimer.innerHTML = \"\";\n        }\n    }\n\n    hideTools() {\n        this.updateButtonTool(this.button5050, 0);\n        this.updateButtonTool(this.buttonSkip, 0);\n        this.updateButtonTool(this.buttonWizard, 0);\n    }\n\n    processSetAnswer(json) {\n        this.correct = json.correct;\n\n        if (json.correct !== undefined) {\n            if (this.qtype === \"multichoice\") {\n                this.onServerAnswerMultichoice(json);\n            }\n        }\n\n        this.disableInput();\n        this.buttonHighScore.style.visibility = 'visible';\n\n        this.isWaitOpponent = false;\n\n        this.showCorrectAnswer(json);\n        this.createNextButton(this.areaRect.width - this.iconSize - this.padding, this.stripTop);\n\n        this.showScore(json);\n\n        this.timeclose = 0;\n\n        if (this.aduelPlayer === 1) {\n            if (json.attempt === 0) {\n                this.timeclose = 0;\n                this.waitOpponent();\n            }\n        }\n\n        if (this.button5050 !== undefined) {\n            this.button5050.style.visibility = 'hidden';\n            this.buttonSkip.style.visibility = 'hidden';\n        }\n    }\n\n    onServerAnswerMultichoice(json) {\n        let foundCorrect = false;\n\n        let aduelAnswers = json.aduelPlayer === 2 && json.aduelUseranswer !== null ? json.aduelUseranswer.split(\",\") : '';\n        let aCorrect = json.correct.split(\",\");\n        for (let i = 0; i < this.answersID.length; i++) {\n            if (this.answersID[i] === '') {\n                continue;\n            }\n\n            let label = this.aItemLabel[i];\n\n            let iscorrect1, iscorrect2;\n\n            let iscorrect = aCorrect.includes(this.answersID[i]);\n\n            if (this.aItemAnswer[i].classList.contains(\"checked\")) {\n                iscorrect1 = aCorrect.includes(this.answersID[i]);\n            }\n            if (iscorrect1) {\n                foundCorrect = true;\n            }\n\n            if (aduelAnswers.includes(this.answersID[i])) {\n                iscorrect2 = aCorrect.includes(this.answersID[i]);\n            }\n\n            if (iscorrect === false && iscorrect1 === undefined && iscorrect2 === undefined) {\n                continue;\n            }\n\n            let width = this.labelWidth;\n            let height = this.aItemLabel[i].scrollHeight;\n\n            let move = (iscorrect2 !== undefined ? 2 : 1) * this.radioSize;\n            if (iscorrect1 === undefined && iscorrect2 === undefined) {\n                move = 0;\n            }\n            width -= move;\n\n            if (move !== 0) {\n                label.style.left = (parseInt(label.style.left) + move) + \"px\";\n            }\n            this.aItemLabel[i].style.width = width + \"px\";\n            this.autoResizeText(this.aItemLabel[i], width, height, true, this.minFontSize, this.maxFontSize, 0.5);\n\n            this.onServerAnswerMultichoiceShowCorrect(i, iscorrect1, iscorrect2);\n        }\n\n        this.playAudio(foundCorrect ? this.audioYes : this.audioNo);\n    }\n\n    onServerAnswerMultichoiceShowCorrect(i, iscorrect1, iscorrect2, iscorrect) {\n        if (iscorrect) {\n            this.aItemLabel[i].innerHTML = '<b><u>' + this.aItemLabel[i].innerHTML + '</b></u>';\n        }\n\n        if (iscorrect1 !== undefined) {\n            let t = parseInt(this.aItemAnswer[i].style.top);\n            let div = this.createDiv(this.area, 'mmogame-quiz-aduel-correct-answer',\n                this.aItemCorrectX[i], t, this.radioSize, this.radioSize);\n            div.title = iscorrect1 ? this.getStringT('js_correct_answer') : this.getStringT('js_wrong_answer');\n            div.innerHTML = this.getSVGcorrect(this.radioSize, iscorrect1, this.colorScore, this.colorScore);\n        }\n\n        if (iscorrect2 !== undefined) {\n            let t = parseInt(this.aItemAnswer[i].style.top);\n            let div = this.createDiv(this.area, 'mmogame-aduel-opponent-correct',\n                this.aItemCorrectX[i] + this.radioSize, t, this.radioSize, this.radioSize);\n            div.innerHTML = this.getSVGcorrect(this.radioSize, iscorrect2, this.colorScore2, this.colorScore2);\n            div.title = iscorrect2 ? this.getStringM('js_correct_answer') : this.getStringM('js_wrong_answer');\n        }\n    }\n\n    showCorrectAnswer({iscorrect2, iscorrect, tool2}) {\n        this.timeclose = 0;\n        this.updateDivTimer();\n\n        this.strip = this.createDiv(this.area, 'mmogame-quiz-aduel-strip',\n            this.stripLeft, this.stripTop, 2 * this.iconSize + this.padding, this.iconSize);\n\n        if (tool2 === undefined || this.aduelPlayer === 2) {\n                const btn = this.createImage(this.area, 'mmogame-quiz-aduel-player1',\n                this.stripLeft + this.iconSize / 2, this.stripTop, this.iconSize,\n            this.iconSize, \"assets/avatars/\" + this.player1.cacheAvatar);\n            btn.style.transform = 'translateX(-50%)';\n        }\n\n        if (tool2 === undefined && this.aduelPlayer === 2) {\n            const btn = this.createImage(this.area, 'mmogame-quiz-aduel-player2',\n                this.stripLeft + this.iconSize / 2 + this.iconSize, this.stripTop, this.iconSize,\n                this.iconSize, \"assets/avatars/\" + this.player2.cacheAvatar);\n            btn.style.transform = 'translateX(-50%)';\n        }\n\n        this.strip.style.top = this.stripTop + \"px\";\n        let s = this.getSVGcorrect(this.iconSize, iscorrect !== 0, this.colorScore, this.colorScore);\n        if (tool2 !== undefined && this.aduelPlayer === 1) {\n            s = '';\n        }\n        if (this.aduelPlayer === 2 && tool2 === undefined) {\n            s += this.getSVGcorrect(this.iconSize, iscorrect2 !== 0, this.colorScore2, this.colorScore2);\n        }\n        this.strip.innerHTML = s;\n\n        this.strip.style.zIndex = '1';\n    }\n\n    showScore(json) {\n        super.showScore(this.player1, json.sumscore, json.rank, json.percent, json.percentRank, true);\n        this.player1.lblAddScore.innerHTML = json.addscore === undefined ? '' : json.addscore;\n        this.autoResizeText(this.player1.lblAddScore, this.player1.cellSize, this.player1.cellSize, true, 0, 0, 1);\n\n        if (json.aduelPlayer === 2) {\n            this.player2.divMain.style.visibility = 'visible';\n            super.showScore(this.player2, json.aduelScore, json.aduelRank, json.aduelPercent, json.aduelPercentRank, true);\n        } else {\n            this.player2.divMain.style.visibility = 'hidden';\n            super.showScore(this.player2, '', '', '', '', false);\n        }\n    }\n\n    sendGetHighScore() {\n        if (this.highScore !== undefined) {\n            this.body.removeChild(this.highScore);\n            this.highScore = undefined;\n            this.strip.style.visibility = 'visible';\n            this.strip.style.zIndex = '1';\n            this.callGetAttempt();\n            return;\n        }\n\n        let params = {\n            mmogameid: this.mmogameid,\n            kinduser: this.kinduser,\n            user: this.user,\n            count: 10,\n        };\n\n        require(['core/ajax'], (Ajax) => {\n            // Calling the service through the Moodle AJAX API\n            let getHighScore = Ajax.call([{\n                methodname: 'mmogametype_quiz_get_highscore',\n                args: params\n            }]);\n\n            // Handling the response\n            getHighScore[0].done((response) => {\n                this.createScreenHighScore(JSON.parse(response));\n            }).fail((error) => {\n                return error;\n            });\n        });\n    }\n\n    createScreenHighScore(json) {\n\n        this.removeDivMessage();\n\n        let child;\n        while ((child = this.area.firstChild)) {\n            this.area.removeChild(child);\n        }\n\n        if (this.isVertical) {\n            this.createScreenVerticalHighScore(json);\n        } else {\n            this.createScreenHorizontalHighScore(json);\n        }\n    }\n\n    createScreenHorizontalHighScore(json) {\n        this.createScreenVerticalHighScore(json);\n    }\n\n    createScreenVerticalHighScore(json) {\n        if (json.count === 0) {\n            return;\n        }\n\n        if (this.strip !== undefined) {\n            this.strip.style.visibility = 'hidden';\n        }\n\n        this.highScore = this.createDivColor(this.body, 'mmogame-quiz-aduel-highscore-background',\n            this.areaRect.left, this.areaRect.top,\n            this.areaRect.width - this.padding, this.areaRect.height - this.padding,\n            this.getColorHex(this.colorBackground));\n\n        let canvas = document.createElement('canvas');\n        canvas.style.left = '0px';\n        canvas.style.top = \"0px\";\n        canvas.width = this.areaRect.width;\n        canvas.height = this.areaRect.height;\n        canvas.style.zIndex = 8;\n        canvas.style.position = \"absolute\";\n\n        this.highScore.appendChild(canvas);\n\n        let ctx = canvas.getContext(\"2d\");\n        let fontSize = this.minFontSize;\n        ctx.font = fontSize + \"px sans-serif\";\n\n        this.drawHighScore1(json, ctx, fontSize);\n    }\n\n    drawHighScore1(json, ctx, fontSize) {\n        ctx.textAlign = \"center\";\n        let text1 = ctx.measureText(this.getStringT('js_ranking_order'));\n        let width1 = text1.width;\n        let text = ctx.measureText(this.getStringM('js_grade'));\n        let width2 = text.width;\n\n        let col1 = 0;\n        let col2 = col1 + width1 + this.padding;\n        let col3 = col2 + width2 + this.padding;\n        let row = Math.round(3 * fontSize * 1.2);\n\n        let results = JSON.parse(json.results);\n\n        ctx.fillStyle = this.getContrastingColor(this.colorBackground);\n\n        let y = Math.round(fontSize * 1.2);\n        ctx.textAlign = \"center\";\n        ctx.fillText(this.getStringT('js_ranking_order'), col1 + width1 / 2, y);\n\n        ctx.fillText(this.getStringM('js_grade'), col2 + width2 / 2, y);\n\n        ctx.textAlign = \"left\";\n        ctx.fillText(this.getStringM('js_name'), col3, y);\n\n        results.forEach(player => {\n            y += row / 2 + this.padding;\n\n            ctx.textAlign = \"center\";\n            ctx.fillText(player.rank, col1 + width1 / 2, y);\n\n            ctx.fillText(player.score, col2 + width2 / 2, y);\n\n            ctx.textAlign = \"left\";\n            ctx.fillText(player.name, col3 + row - this.padding, y);\n\n            this.createImage(this.highScore, 'mmogame-quiz-aduel-player-avatars',\n                col3, y - row / 2, row - this.padding, row - this.padding,\n                'assets/avatars/' + player.avatar);\n\n            y += row / 2 - this.padding;\n        });\n    }\n\n    showHelpScreen(div) {\n        div.innerHTML = `<div> ${this.getStringT('js_aduel_help')} </div>\n<table class=\"mmogame-table-help\">\n    <tr>\n        <td class=\"mmogame-td-help-image\">\n            <img height=\"90\" src=\"assets/cutred.svg\" alt=\"\" />\n        </td>\n        <td> ${this.getStringT('js_aduel_cut')} </td>\n        <td class=\"mmogame-td-help-image\">\n            <img height=\"90\" src=\"assets/skip.svg\" alt=\"\" />\n        </td>\n        <td> ${this.getStringT('js_aduel_skip')} </td>\n    </tr>\n\n    <tr>\n        <td class=\"mmogame-td-help-image\">\n            <img height=\"90\" src=\"assets/wizard.svg\" alt=\"\" />\n        </td>\n        <td> ${this.getStringT('js_aduel_wizard')} </td>\n        \n        <td class=\"mmogame-td-help-image\">\n            <img height=\"90\" src=\"type/quiz/assets/aduel/example1.png\" alt=\"\" />\n        </td>\n\n        <td> ${this.getStringT('js_aduel_example1')} </td>\n    </tr>\n    <tr>\n        <td class=\"mmogame-td-help-image\">\n            <img height=\"83\" src=\"type/quiz/assets/aduel/example2.png\" alt=\"\" />\n        </td>\n        <td> ${this.getStringT('js_aduel_example2')} </td>\n    </tr>\n</table>\n        `;\n    }\n\n    /**\n     * Creates a timer display.\n     * @param {any} parent\n     * @param {number} left - Left position in pixels.\n     * @param {number} top - Top position in pixels.\n     * @param {number} size - Timer size.\n     */\n    createDivTimer(parent, left, top, size) {\n        this.divTimer = this.createDOMElement('div', {\n            parent: parent,\n            classnames: 'mmogame-quiz-aduel-timer',\n            styles: {\n                position: 'absolute',\n                left: `${left}px`,\n                top: `${top}px`,\n                width: `${size}px`,\n                height: `${size}px`,\n                textAlign: 'center',\n                color: this.getContrastingColor(this.colorBackground),\n            },\n            attributes: {\n                alt: this.getStringM('js_question_time'),\n            },\n        });\n\n        this.divTimer.innerHTML = '23:59';\n        this.autoResizeText(this.divTimer, size, size, false, 0, 0);\n        this.divTimer.innerHTML = '';\n        this.divTimer.title = this.getStringM('js_question_time');\n    }\n\n    updateDivTimer() {\n        if (this.state === 0) {\n            if (this.divTimer !== undefined) {\n                this.divTimer.innerHTML = '';\n            }\n            return;\n        }\n        // Exit if labelTimer or timeclose are undefined\n        if (!this.divTimer || !this.timeclose) {\n            return;\n        }\n\n        // Calculate the remaining time in seconds\n        const now = Date.now() / 1000; // Get current time in seconds\n        let remainingTime = Math.max(0, this.timeclose - now);\n\n        // If no time is remaining, clear the label and handle timeout\n        if (remainingTime === 0) {\n            this.divTimer.innerHTML = '';\n            this.onTimeout();\n            return;\n        }\n\n        // Format the remaining time as mm:ss\n        const minutes = Math.floor(remainingTime / 60);\n        const seconds = String(Math.floor(remainingTime % 60)).padStart(2, '0');\n        this.divTimer.innerHTML = `${minutes}:${seconds}`;\n\n        // Set a timeout to update the timer every 500ms\n        this.timerTimeout = setTimeout(() => this.updateDivTimer(), 500);\n    }\n    createScreen(json, disabled) {\n        if (this.endofgame) {\n            // Display end-of-game message and final score\n            this.createDivMessage('mmogame-endofgame', this.getStringM('js_game_over'));\n            this.showScore(json);\n            return;\n        }\n\n        this.removeAreaChildren();\n\n        // Render the screen layout based on orientation (vertical or horizontal)\n        if (this.isVertical) {\n            this.createScreenVertical(json, disabled);\n        } else {\n            this.createScreenHorizontal(json, disabled);\n        }\n\n        // Display the current score\n        this.showScore(json);\n    }\n\n    createScreenHorizontal(json, disabled) {\n        const [width] = this.computeBestFontSize(json);\n\n        this.radioSize = Math.round(this.fontSize);\n        this.stripTop = this.createAnswer(width, 0, width - this.padding, false, this.fontSize, disabled);\n\n        this.createDefinition(0, 0, width - this.padding, this.stripTop - this.padding,\n            false, this.fontSize, json.definition);\n\n        // Adjust strip dimensions\n        this.stripLeft = width + this.padding;\n    }\n\n    createScreenVertical(json, disabled) {\n        this.computeBestFontSize(json);\n\n        this.radioSize = Math.round(this.fontSize);\n\n        const defSize = this.createDefinition(0, 0, this.areaRect.width, 0, false, this.fontSize, json.definition);\n        this.stripTop = this.createAnswer(0, defSize[1] + this.padding, this.areaRect.width, false, this.fontSize, disabled);\n\n        // Adjust strip position\n        this.stripLeft = 0;\n    }\n\n    showWaitOpponent() {\n        if (this.isWaitOpponent) {\n            return;\n        }\n        this.updateNicknameAvatar(this.player2, '', '', 0, 0);\n        this.createDivMessage(this.getStringT('js_aduel_wait_opponent'));\n        if (this.divTimer !== undefined) {\n            this.divTimer.innerHTML = \"\";\n        }\n    }\n\n    hasHelp() {\n        return true;\n    }\n\n    };\n});"],"names":["define","MmoGameTypeQuiz","player1","player2","isWaitOpponent","divTimer","timerTimeout","stripLeft","stripTop","timeoutWaitOpponent","buttonHighScore","button5050","buttonSkip","buttonWizard","buttonHelp","constructor","cIcons","this","isVertical","hasHelp","createIconBar","i","step","iconSize","padding","nicknameHeight","Math","round","fragment","document","createDocumentFragment","nickname","avatar","leftButton","createNicknameAvatar","createDivScorePercent","colorScore","avatarElement","nicknameElement","cacheAvatar","cacheNickname","lblScore","title","getStringM","lblRank","colorScore2","createArea","createDivTimer","body","createButtonSound","areaRect","top","height","createImageButton","style","visibility","addEventListener","sendGetHighScore","callGetAttempt","subcommand","getStringT","callSetAnswer","createButtonHelp","onClickHelp","appendChild","updateButtonTool","btn","tool","undefined","parseInt","processGetAttempt","json","name","window","correct","state","nicknameWidth","qtype","setColorsString","colors","hideTools","updateNicknameAvatar","showScore","createDivMessageStart","sendFastJSON","computeTimeStartClose","timestart","timeclose","savedColors","area","bottom","aduelAvatar","aduelNickname","tool1","tool3","tool2numattempt","tool3numattempt","tool2","attempt","aduelPlayer","aduelScore","aduelRank","errorcode","param","showWaitOpponent","timeout","setTimeout","answers","answersID","answerids","forEach","answer","index","repairP","definition","aduelAttempt","single","createScreen","updateDivTimer","onTimeout","innerHTML","disableInput","answerid","createNextButton","width","waitOpponent","createDivMessage","labelTimer","processSetAnswer","onServerAnswerMultichoice","showCorrectAnswer","foundCorrect","aduelAnswers","aduelUseranswer","split","aCorrect","length","iscorrect1","iscorrect2","label","aItemLabel","iscorrect","includes","aItemAnswer","classList","contains","labelWidth","scrollHeight","move","radioSize","left","autoResizeText","minFontSize","maxFontSize","onServerAnswerMultichoiceShowCorrect","playAudio","audioYes","audioNo","t","div","createDiv","aItemCorrectX","getSVGcorrect","strip","createImage","transform","s","zIndex","sumscore","rank","percent","percentRank","lblAddScore","addscore","cellSize","divMain","aduelPercent","aduelPercentRank","highScore","removeChild","params","mmogameid","kinduser","user","count","require","Ajax","call","methodname","args","done","response","createScreenHighScore","JSON","parse","fail","error","child","removeDivMessage","firstChild","createScreenVerticalHighScore","createScreenHorizontalHighScore","createDivColor","getColorHex","colorBackground","canvas","createElement","position","ctx","getContext","fontSize","font","drawHighScore1","textAlign","width1","measureText","width2","col2","col3","row","results","fillStyle","getContrastingColor","y","fillText","player","score","showHelpScreen","parent","size","createDOMElement","classnames","styles","color","attributes","alt","now","Date","remainingTime","max","minutes","floor","seconds","String","padStart","disabled","endofgame","removeAreaChildren","createScreenVertical","createScreenHorizontal","computeBestFontSize","createAnswer","createDefinition","defSize"],"mappings":"AAeAA,+CAAO,CAAC,qCACJ,SAASC,wBACE,cAAmCA,gBAE9CC,QACAC,QACAC,eAGAC,SACAC,aAEAC,UACAC,SAEAC,oBAAsB,IAGtBC,gBACAC,WACAC,WACAC,aACAC,WAEAC,oBACU,cAGDC,QAAUC,KAAKC,WAAa,EAAI,IAAMD,KAAKE,UAAY,EAAI,QAE3Df,gBAAiB,EAG1BgB,oBACQC,EAAI,QACFC,KAAOL,KAAKM,SAAWN,KAAKO,QAE5BC,eAAiBC,KAAKC,MAAMV,KAAKM,SAAW,GAC5CK,SAAWC,SAASC,6BAEtBC,SAAUC,OAkDVC,YAjDHF,SAAUC,QAAUf,KAAKiB,qBAAqBN,SAAU,qBACrDF,KAAKC,MAAMV,KAAKO,QAAWH,IAAOC,MAClCL,KAAKO,QACL,EAAIP,KAAKM,SAAWN,KAAKO,QACzBC,eACAR,KAAKO,QAAUC,eACfR,KAAKM,eAEJrB,QAAUe,KAAKkB,sBAAsBP,SAAU,6BAChDX,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,SAAUP,KAAKO,QAAUC,gBACtE,EAAMR,KAAKmB,iBACVlC,QAAQmC,cAAgBL,YACxB9B,QAAQoC,gBAAkBP,cAC1B7B,QAAQqC,YAAc,QACtBrC,QAAQsC,cAAgB,QACxBtC,QAAQuC,SAASC,MAAQzB,KAAK0B,WAAW,iBACzCzC,QAAQ0C,QAAQF,MAAQzB,KAAK0B,WAAW,sBAE5CZ,SAAUC,QAAUf,KAAKiB,qBAAqBN,SAAU,qBACrDF,KAAKC,MAAMV,KAAKO,QAAWH,IAAOC,MAClCL,KAAKO,QACL,EAAIP,KAAKM,SAAWN,KAAKO,QACzBC,eACAR,KAAKO,QAAUC,eACfR,KAAKM,eAEJpB,QAAUc,KAAKkB,sBAAsBP,SAAU,6BAChDX,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,SAAUP,KAAKO,QAAUC,gBACtE,EAAOR,KAAK4B,kBACX1C,QAAQkC,cAAgBL,YACxB7B,QAAQmC,gBAAkBP,cAC1B5B,QAAQoC,YAAc,QACtBpC,QAAQqC,cAAgB,QACxBrC,QAAQsC,SAASC,MAAQzB,KAAK0B,WAAW,4BACzCxC,QAAQyC,QAAQF,MAAQzB,KAAK0B,WAAW,4BAExCG,WAAW,EAAI7B,KAAKO,QAAUP,KAAKM,SAAWE,eAAgBR,KAAKC,WAAaD,KAAKM,SAAW,QAEhGwB,eAAe9B,KAAK+B,KAAM/B,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,SAAUP,KAAKO,QAAUC,eACjGR,KAAKM,UAELN,KAAKC,YACLG,EAAI,OACC4B,kBAAkBrB,SACnBX,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,SAAUP,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,cAExFH,kBAAkBrB,SAAUX,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,SAAUP,KAAKO,QAAUC,gBAIvGR,KAAKC,YACLe,WAAahB,KAAKO,SAAWP,KAAKM,SAAWN,KAAKO,cAC7Cd,gBAAkBO,KAAKoC,kBAAkBzB,SAAU,yBACpDK,WAAYhB,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,OAC9CnC,KAAKM,SAAUN,KAAKM,SAAU,6BAE7BZ,WAAaM,KAAKoC,kBAAkBzB,SAAU,0BAC/CK,WAAYhB,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,OAAQnC,KAAKM,SAAUN,KAAKM,SAC1E,uBAEJU,WAAahB,KAAKO,QAAWH,KAAQJ,KAAKM,SAAWN,KAAKO,cAErDd,gBAAkBO,KAAKoC,kBAAkBzB,SAAU,yBACpDK,WAAYhB,KAAKO,QAAUC,eAAgBR,KAAKM,SAAUN,KAAKM,SAC/D,6BAECZ,WAAaM,KAAKoC,kBAAkBzB,SAAU,0BAC/CK,WAAYhB,KAAKO,QAAUC,eAAgBR,KAAKM,SAAUN,KAAKM,SAC/D,2BAEHb,gBAAgB4C,MAAMC,WAAa,cACnC7C,gBAAgB8C,iBAAiB,SAAS,UACtCC,2BAEJ9C,WAAW6C,iBAAiB,SAAS,UACjCE,eAAe,CAACC,WAAY,kBAEhChD,WAAW+B,MAAQzB,KAAK2C,WAAW,gBAExC3B,YAAchB,KAAKM,SAAWN,KAAKO,QAG/BP,KAAKC,gBACAN,WAAaK,KAAKoC,kBAAkBzB,SAAU,0BAC/CK,WAAYhB,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,OAAQnC,KAAKM,SAAUN,KAAKM,SAC1E,wBAECX,WAAaK,KAAKoC,kBAAkBzB,SAAU,0BAC/CK,WAAYhB,KAAKO,QAAUC,eAAgBR,KAAKM,SAChDN,KAAKM,SAAU,wBAElBX,WAAW4C,iBAAiB,SAAS,UACjCK,cAAc,iBAElBjD,WAAW8B,MAAQzB,KAAK2C,WAAW,gBAEpC3C,KAAKC,gBACAL,aAAeI,KAAKoC,kBAAkBzB,SAAU,4BACjDK,WAAYhB,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,OAAQnC,KAAKM,SAAUN,KAAKM,SAC1E,0BAECV,aAAeI,KAAKoC,kBAAkBzB,SAAU,4BACjDK,WAAYhB,KAAKO,QAAUC,eAAgBR,KAAKM,SAChDN,KAAKM,SAAU,0BAElBV,aAAa2C,iBAAiB,SAAS,UACnCE,eAAe,YAAe,kBAElC7C,aAAayC,MAAMC,WAAa,cAChC1C,aAAa6B,MAAQzB,KAAK2C,WAAW,aAEtC3C,KAAKE,YACDF,KAAKC,gBACAJ,WAAaG,KAAK6C,iBAAiBlC,SACpCK,WAAahB,KAAKM,SAAWN,KAAKO,QAASP,KAAKiC,SAASC,IAAMlC,KAAKiC,SAASE,aAE5EtC,WAAaG,KAAK6C,iBAAiBlC,SACpCK,WAAahB,KAAKM,SAAWN,KAAKO,QAASP,KAAKO,QAAUC,qBAE7DX,WAAW0C,iBAAiB,SAAS,IAAMvC,KAAK8C,sBAGpDf,KAAKgB,YAAYpC,UAG1BqC,iBAAiBC,IAAKC,MAClBD,IAAIZ,MAAMC,gBAAsBa,IAATD,MAAyC,IAAnBE,SAASF,MAAc,UAAY,SAGpFG,kBAAkBC,YACRD,kBAAkBC,WACKH,IAAzBnD,KAAKP,uBACAA,gBAAgB4C,MAAMC,WAAa,eAG1Ba,IAAdG,KAAKC,OACLC,OAAO5C,SAASa,MAAQ6B,KAAKC,WAE5BE,aAAUN,OAGVO,MAAQN,SAASE,KAAKI,aAErBC,cAAgB,EAAI3D,KAAKM,SAAWN,KAAKO,QACzCC,eAAiBC,KAAKC,MAAMV,KAAKM,SAAW,UAC/B,IAAfN,KAAK0D,OACLJ,KAAKM,MAAQ,QACWT,IAApBnD,KAAKN,kBACAmE,gBAAgBP,KAAKQ,aACrB3D,sBAEJ4D,iBACAC,qBAAqBhE,KAAKf,QAASqE,KAAKvC,OAAQuC,KAAKxC,SAAU6C,cAAenD,qBAC9EyD,UAAUX,WAEVY,sBAAsBlE,KAAK0B,WAAW,0BACtCyC,yBACmBhB,IAApBnD,KAAKH,kBACAA,WAAWwC,MAAMC,WAAa,kBAKtC8B,sBAAsBd,KAAKe,UAAWf,KAAKgB,gBAGvBnB,IAArBnD,KAAKuE,aAA6BvE,KAAKuE,cAAgBjB,KAAKQ,cACvDS,YAAcjB,KAAKQ,YACnBA,YAASX,GAGdG,KAAKC,OACL3C,SAASa,MAAQ6B,KAAKC,WAELJ,IAAjBnD,KAAKf,eACA4E,gBAAgBP,KAAKQ,aACrB3D,sBAGSgD,IAAdnD,KAAKwE,WACA3C,WAAW7B,KAAKiC,SAASC,IAAKlC,KAAKiC,SAASwC,aAGhDT,qBAAqBhE,KAAKf,QAASqE,KAAKvC,OAAQuC,KAAKxC,SAAU6C,cAAenD,qBAC9EwD,qBAAqBhE,KAAKd,QAASoE,KAAKoB,YAAapB,KAAKqB,cAAehB,cAAenD,qBAExFwC,iBAAiBhD,KAAKN,WAAY4D,KAAKsB,YACzBzB,IAAfG,KAAKuB,MACLvB,KAAKwB,iBAAmB,EAExBxB,KAAKyB,iBAAmB,OAEvB/B,iBAAiBhD,KAAKL,WAAY2D,KAAK0B,YACvChC,iBAAiBhD,KAAKJ,aAAc0D,KAAKuB,YAEzCI,QAAU3B,KAAK2B,aACfC,YAAc5B,KAAK4B,iBACnBC,WAAa7B,KAAK6B,gBAClBC,UAAY9B,KAAK8B,eAECjC,IAAnBG,KAAK+B,WAA8C,oBAAnB/B,KAAK+B,WAAoD,IAAjB/B,KAAK2B,cAC1D9B,IAAfG,KAAKgC,YACAC,wBAEJxB,iBACAE,UAAUX,gBACVkC,QAAUC,YAAW,UACjBhD,mBACNzC,KAAKR,6BAIPL,gBAAiB,OAEjByE,MAAQN,KAAKM,MACC,gBAAfN,KAAKM,aACA8B,QAAU,QACVC,UAAYrC,KAAKsC,UAEtBtC,KAAKoC,QAAQG,SAAQ,CAACC,OAAQC,cACrBL,QAAQK,OAAS/F,KAAKgG,QAAQF,iBAGtCA,YAAyB3C,IAAhBG,KAAKwC,OAAuBxC,KAAKwC,OAAS,UACnDG,WAAajG,KAAKgG,QAAQ1C,KAAK2C,iBACV9C,IAAtBG,KAAK4C,oBACAD,WAAa3C,KAAK4C,aAAe,KAAOlG,KAAKiG,iBAEjDE,OAAS7C,KAAK6C,YACdd,UAAY/B,KAAK+B,eAEjBe,aAAa9C,MAAM,QACnB+C,sBACAlC,yBAEmBhB,IAApBnD,KAAKH,kBACAA,WAAWwC,MAAMC,WAAa,cAI3CgE,iBACSlH,SAASmH,UAAY,QACrBC,oBAEAV,OAAS,QACTW,SAAW,OACX7D,qBAEA8D,iBAAiB1G,KAAKiC,SAAS0E,MAAQ3G,KAAKM,SAAWN,KAAKO,QAASP,KAAKT,UAGnFqH,eACQ5G,KAAKb,sBAGJ6E,qBAAqBhE,KAAKd,QAAS,GAAI,SACvC2H,iBAAiB,oCAClB7G,KAAK2C,WAAW,gCACIQ,IAApBnD,KAAK8G,kBACAA,WAAWP,UAAY,KAIpCxC,iBACSf,iBAAiBhD,KAAKN,WAAY,QAClCsD,iBAAiBhD,KAAKL,WAAY,QAClCqD,iBAAiBhD,KAAKJ,aAAc,GAG7CmH,iBAAiBzD,WACRG,QAAUH,KAAKG,aAECN,IAAjBG,KAAKG,SACc,gBAAfzD,KAAK4D,YACAoD,0BAA0B1D,WAIlCkD,oBACA/G,gBAAgB4C,MAAMC,WAAa,eAEnCnD,gBAAiB,OAEjB8H,kBAAkB3D,WAClBoD,iBAAiB1G,KAAKiC,SAAS0E,MAAQ3G,KAAKM,SAAWN,KAAKO,QAASP,KAAKT,eAE1E0E,UAAUX,WAEVgB,UAAY,EAEQ,IAArBtE,KAAKkF,aACgB,IAAjB5B,KAAK2B,eACAX,UAAY,OACZsC,qBAIWzD,IAApBnD,KAAKN,kBACAA,WAAW2C,MAAMC,WAAa,cAC9B3C,WAAW0C,MAAMC,WAAa,UAI3C0E,0BAA0B1D,UAClB4D,cAAe,EAEfC,aAAoC,IAArB7D,KAAK4B,aAA8C,OAAzB5B,KAAK8D,gBAA2B9D,KAAK8D,gBAAgBC,MAAM,KAAO,GAC3GC,SAAWhE,KAAKG,QAAQ4D,MAAM,SAC7B,IAAIjH,EAAI,EAAGA,EAAIJ,KAAK2F,UAAU4B,OAAQnH,IAAK,IAClB,KAAtBJ,KAAK2F,UAAUvF,gBAMfoH,WAAYC,WAFZC,MAAQ1H,KAAK2H,WAAWvH,GAIxBwH,UAAYN,SAASO,SAAS7H,KAAK2F,UAAUvF,OAE7CJ,KAAK8H,YAAY1H,GAAG2H,UAAUC,SAAS,aACvCR,WAAaF,SAASO,SAAS7H,KAAK2F,UAAUvF,KAE9CoH,aACAN,cAAe,GAGfC,aAAaU,SAAS7H,KAAK2F,UAAUvF,MACrCqH,WAAaH,SAASO,SAAS7H,KAAK2F,UAAUvF,MAGhC,IAAdwH,gBAAsCzE,IAAfqE,iBAA2CrE,IAAfsE,wBAInDd,MAAQ3G,KAAKiI,WACb9F,OAASnC,KAAK2H,WAAWvH,GAAG8H,aAE5BC,WAAuBhF,IAAfsE,WAA2B,EAAI,GAAKzH,KAAKoI,eAClCjF,IAAfqE,iBAA2CrE,IAAfsE,aAC5BU,KAAO,GAEXxB,OAASwB,KAEI,IAATA,OACAT,MAAMrF,MAAMgG,KAAQjF,SAASsE,MAAMrF,MAAMgG,MAAQF,KAAQ,WAExDR,WAAWvH,GAAGiC,MAAMsE,MAAQA,MAAQ,UACpC2B,eAAetI,KAAK2H,WAAWvH,GAAIuG,MAAOxE,QAAQ,EAAMnC,KAAKuI,YAAavI,KAAKwI,YAAa,SAE5FC,qCAAqCrI,EAAGoH,WAAYC,iBAGxDiB,UAAUxB,aAAelH,KAAK2I,SAAW3I,KAAK4I,SAGvDH,qCAAqCrI,EAAGoH,WAAYC,WAAYG,cACxDA,iBACKD,WAAWvH,GAAGmG,UAAY,SAAWvG,KAAK2H,WAAWvH,GAAGmG,UAAY,iBAG1DpD,IAAfqE,WAA0B,KACtBqB,EAAIzF,SAASpD,KAAK8H,YAAY1H,GAAGiC,MAAMH,KACvC4G,IAAM9I,KAAK+I,UAAU/I,KAAKwE,KAAM,oCAChCxE,KAAKgJ,cAAc5I,GAAIyI,EAAG7I,KAAKoI,UAAWpI,KAAKoI,WACnDU,IAAIrH,MAAQ+F,WAAaxH,KAAK2C,WAAW,qBAAuB3C,KAAK2C,WAAW,mBAChFmG,IAAIvC,UAAYvG,KAAKiJ,cAAcjJ,KAAKoI,UAAWZ,WAAYxH,KAAKmB,WAAYnB,KAAKmB,oBAGtEgC,IAAfsE,WAA0B,KACtBoB,EAAIzF,SAASpD,KAAK8H,YAAY1H,GAAGiC,MAAMH,KACvC4G,IAAM9I,KAAK+I,UAAU/I,KAAKwE,KAAM,iCAChCxE,KAAKgJ,cAAc5I,GAAKJ,KAAKoI,UAAWS,EAAG7I,KAAKoI,UAAWpI,KAAKoI,WACpEU,IAAIvC,UAAYvG,KAAKiJ,cAAcjJ,KAAKoI,UAAWX,WAAYzH,KAAK4B,YAAa5B,KAAK4B,aACtFkH,IAAIrH,MAAQgG,WAAazH,KAAK0B,WAAW,qBAAuB1B,KAAK0B,WAAW,oBAIxFuF,4BAAkBQ,WAACA,WAADG,UAAaA,UAAb5C,MAAwBA,oBACjCV,UAAY,OACZ+B,sBAEA6C,MAAQlJ,KAAK+I,UAAU/I,KAAKwE,KAAM,2BACnCxE,KAAKV,UAAWU,KAAKT,SAAU,EAAIS,KAAKM,SAAWN,KAAKO,QAASP,KAAKM,eAE5D6C,IAAV6B,OAA4C,IAArBhF,KAAKkF,YAAmB,CAC/BlF,KAAKmJ,YAAYnJ,KAAKwE,KAAM,6BACxCxE,KAAKV,UAAYU,KAAKM,SAAW,EAAGN,KAAKT,SAAUS,KAAKM,SAC5DN,KAAKM,SAAU,kBAAoBN,KAAKf,QAAQqC,aAC5Ce,MAAM+G,UAAY,2BAGZjG,IAAV6B,OAA4C,IAArBhF,KAAKkF,YAAmB,CACnClF,KAAKmJ,YAAYnJ,KAAKwE,KAAM,6BACpCxE,KAAKV,UAAYU,KAAKM,SAAW,EAAIN,KAAKM,SAAUN,KAAKT,SAAUS,KAAKM,SACxEN,KAAKM,SAAU,kBAAoBN,KAAKd,QAAQoC,aAChDe,MAAM+G,UAAY,wBAGrBF,MAAM7G,MAAMH,IAAMlC,KAAKT,SAAW,SACnC8J,EAAIrJ,KAAKiJ,cAAcjJ,KAAKM,SAAwB,IAAdsH,UAAiB5H,KAAKmB,WAAYnB,KAAKmB,iBACnEgC,IAAV6B,OAA4C,IAArBhF,KAAKkF,cAC5BmE,EAAI,IAEiB,IAArBrJ,KAAKkF,kBAA+B/B,IAAV6B,QAC1BqE,GAAKrJ,KAAKiJ,cAAcjJ,KAAKM,SAAyB,IAAfmH,WAAkBzH,KAAK4B,YAAa5B,KAAK4B,mBAE/EsH,MAAM3C,UAAY8C,OAElBH,MAAM7G,MAAMiH,OAAS,IAG9BrF,UAAUX,YACAW,UAAUjE,KAAKf,QAASqE,KAAKiG,SAAUjG,KAAKkG,KAAMlG,KAAKmG,QAASnG,KAAKoG,aAAa,QACnFzK,QAAQ0K,YAAYpD,eAA8BpD,IAAlBG,KAAKsG,SAAyB,GAAKtG,KAAKsG,cACxEtB,eAAetI,KAAKf,QAAQ0K,YAAa3J,KAAKf,QAAQ4K,SAAU7J,KAAKf,QAAQ4K,UAAU,EAAM,EAAG,EAAG,GAE/E,IAArBvG,KAAK4B,kBACAhG,QAAQ4K,QAAQzH,MAAMC,WAAa,gBAClC2B,UAAUjE,KAAKd,QAASoE,KAAK6B,WAAY7B,KAAK8B,UAAW9B,KAAKyG,aAAczG,KAAK0G,kBAAkB,UAEpG9K,QAAQ4K,QAAQzH,MAAMC,WAAa,eAClC2B,UAAUjE,KAAKd,QAAS,GAAI,GAAI,GAAI,IAAI,IAItDsD,2BAC2BW,IAAnBnD,KAAKiK,sBACAlI,KAAKmI,YAAYlK,KAAKiK,gBACtBA,eAAY9G,OACZ+F,MAAM7G,MAAMC,WAAa,eACzB4G,MAAM7G,MAAMiH,OAAS,cACrB7G,qBAIL0H,OAAS,CACTC,UAAWpK,KAAKoK,UAChBC,SAAUrK,KAAKqK,SACfC,KAAMtK,KAAKsK,KACXC,MAAO,IAGXC,QAAQ,CAAC,cAAeC,OAEDA,KAAKC,KAAK,CAAC,CAC1BC,WAAY,iCACZC,KAAMT,UAIG,GAAGU,MAAMC,gBACbC,sBAAsBC,KAAKC,MAAMH,cACvCI,MAAMC,OACEA,WAKnBJ,sBAAsBzH,UAId8H,eAFCC,mBAGGD,MAAQpL,KAAKwE,KAAK8G,iBACjB9G,KAAK0F,YAAYkB,OAGtBpL,KAAKC,gBACAsL,8BAA8BjI,WAE9BkI,gCAAgClI,MAI7CkI,gCAAgClI,WACvBiI,8BAA8BjI,MAGvCiI,8BAA8BjI,SACP,IAAfA,KAAKiH,kBAIUpH,IAAfnD,KAAKkJ,aACAA,MAAM7G,MAAMC,WAAa,eAG7B2H,UAAYjK,KAAKyL,eAAezL,KAAK+B,KAAM,0CAC5C/B,KAAKiC,SAASoG,KAAMrI,KAAKiC,SAASC,IAClClC,KAAKiC,SAAS0E,MAAQ3G,KAAKO,QAASP,KAAKiC,SAASE,OAASnC,KAAKO,QAChEP,KAAK0L,YAAY1L,KAAK2L,sBAEtBC,OAAShL,SAASiL,cAAc,UACpCD,OAAOvJ,MAAMgG,KAAO,MACpBuD,OAAOvJ,MAAMH,IAAM,MACnB0J,OAAOjF,MAAQ3G,KAAKiC,SAAS0E,MAC7BiF,OAAOzJ,OAASnC,KAAKiC,SAASE,OAC9ByJ,OAAOvJ,MAAMiH,OAAS,EACtBsC,OAAOvJ,MAAMyJ,SAAW,gBAEnB7B,UAAUlH,YAAY6I,YAEvBG,IAAMH,OAAOI,WAAW,MACxBC,SAAWjM,KAAKuI,YACpBwD,IAAIG,KAAOD,SAAW,qBAEjBE,eAAe7I,KAAMyI,IAAKE,UAGnCE,eAAe7I,KAAMyI,IAAKE,UACtBF,IAAIK,UAAY,aAEZC,OADQN,IAAIO,YAAYtM,KAAK2C,WAAW,qBACzBgE,MAEf4F,OADOR,IAAIO,YAAYtM,KAAK0B,WAAW,aACzBiF,MAGd6F,KADO,EACOH,OAASrM,KAAKO,QAC5BkM,KAAOD,KAAOD,OAASvM,KAAKO,QAC5BmM,IAAMjM,KAAKC,MAAM,EAAIuL,SAAW,KAEhCU,QAAU3B,KAAKC,MAAM3H,KAAKqJ,SAE9BZ,IAAIa,UAAY5M,KAAK6M,oBAAoB7M,KAAK2L,qBAE1CmB,EAAIrM,KAAKC,MAAiB,IAAXuL,UACnBF,IAAIK,UAAY,SAChBL,IAAIgB,SAAS/M,KAAK2C,WAAW,oBAXlB,EAW8C0J,OAAS,EAAGS,GAErEf,IAAIgB,SAAS/M,KAAK0B,WAAW,YAAa8K,KAAOD,OAAS,EAAGO,GAE7Df,IAAIK,UAAY,OAChBL,IAAIgB,SAAS/M,KAAK0B,WAAW,WAAY+K,KAAMK,GAE/CH,QAAQ9G,SAAQmH,SACZF,GAAKJ,IAAM,EAAI1M,KAAKO,QAEpBwL,IAAIK,UAAY,SAChBL,IAAIgB,SAASC,OAAOxD,KAtBb,EAsB0B6C,OAAS,EAAGS,GAE7Cf,IAAIgB,SAASC,OAAOC,MAAOT,KAAOD,OAAS,EAAGO,GAE9Cf,IAAIK,UAAY,OAChBL,IAAIgB,SAASC,OAAOzJ,KAAMkJ,KAAOC,IAAM1M,KAAKO,QAASuM,QAEhD3D,YAAYnJ,KAAKiK,UAAW,oCAC7BwC,KAAMK,EAAIJ,IAAM,EAAGA,IAAM1M,KAAKO,QAASmM,IAAM1M,KAAKO,QAClD,kBAAoByM,OAAOjM,QAE/B+L,GAAKJ,IAAM,EAAI1M,KAAKO,WAI5B2M,eAAepE,KACXA,IAAIvC,UAAa,SAAQvG,KAAK2C,WAAW,kNAMlC3C,KAAK2C,WAAW,gKAIhB3C,KAAK2C,WAAW,0LAOhB3C,KAAK2C,WAAW,mMAMhB3C,KAAK2C,WAAW,8MAMhB3C,KAAK2C,WAAW,4DAa3Bb,eAAeqL,OAAQ9E,KAAMnG,IAAKkL,WACzBhO,SAAWY,KAAKqN,iBAAiB,MAAO,CACzCF,OAAQA,OACRG,WAAY,2BACZC,OAAQ,CACJzB,SAAU,WACVzD,KAAO,GAAEA,SACTnG,IAAM,GAAEA,QACRyE,MAAQ,GAAEyG,SACVjL,OAAS,GAAEiL,SACXhB,UAAW,SACXoB,MAAOxN,KAAK6M,oBAAoB7M,KAAK2L,kBAEzC8B,WAAY,CACRC,IAAK1N,KAAK0B,WAAW,4BAIxBtC,SAASmH,UAAY,aACrB+B,eAAetI,KAAKZ,SAAUgO,KAAMA,MAAM,EAAO,EAAG,QACpDhO,SAASmH,UAAY,QACrBnH,SAASqC,MAAQzB,KAAK0B,WAAW,oBAG1C2E,oBACuB,IAAfrG,KAAK0D,uBACiBP,IAAlBnD,KAAKZ,gBACAA,SAASmH,UAAY,SAK7BvG,KAAKZ,WAAaY,KAAKsE,uBAKtBqJ,IAAMC,KAAKD,MAAQ,QACrBE,cAAgBpN,KAAKqN,IAAI,EAAG9N,KAAKsE,UAAYqJ,QAG3B,IAAlBE,0BACKzO,SAASmH,UAAY,aACrBD,kBAKHyH,QAAUtN,KAAKuN,MAAMH,cAAgB,IACrCI,QAAUC,OAAOzN,KAAKuN,MAAMH,cAAgB,KAAKM,SAAS,EAAG,UAC9D/O,SAASmH,UAAa,GAAEwH,WAAWE,eAGnC5O,aAAeoG,YAAW,IAAMzF,KAAKqG,kBAAkB,KAEhED,aAAa9C,KAAM8K,aACXpO,KAAKqO,sBAEAxH,iBAAiB,oBAAqB7G,KAAK0B,WAAW,2BACtDuC,UAAUX,WAIdgL,qBAGDtO,KAAKC,gBACAsO,qBAAqBjL,KAAM8K,eAE3BI,uBAAuBlL,KAAM8K,eAIjCnK,UAAUX,MAGnBkL,uBAAuBlL,KAAM8K,gBAClBzH,OAAS3G,KAAKyO,oBAAoBnL,WAEpC8E,UAAY3H,KAAKC,MAAMV,KAAKiM,eAC5B1M,SAAWS,KAAK0O,aAAa/H,MAAO,EAAGA,MAAQ3G,KAAKO,SAAS,EAAOP,KAAKiM,SAAUmC,eAEnFO,iBAAiB,EAAG,EAAGhI,MAAQ3G,KAAKO,QAASP,KAAKT,SAAWS,KAAKO,SACnE,EAAOP,KAAKiM,SAAU3I,KAAK2C,iBAG1B3G,UAAYqH,MAAQ3G,KAAKO,QAGlCgO,qBAAqBjL,KAAM8K,eAClBK,oBAAoBnL,WAEpB8E,UAAY3H,KAAKC,MAAMV,KAAKiM,gBAE3B2C,QAAU5O,KAAK2O,iBAAiB,EAAG,EAAG3O,KAAKiC,SAAS0E,MAAO,GAAG,EAAO3G,KAAKiM,SAAU3I,KAAK2C,iBAC1F1G,SAAWS,KAAK0O,aAAa,EAAGE,QAAQ,GAAK5O,KAAKO,QAASP,KAAKiC,SAAS0E,OAAO,EAAO3G,KAAKiM,SAAUmC,eAGtG9O,UAAY,EAGrBiG,mBACQvF,KAAKb,sBAGJ6E,qBAAqBhE,KAAKd,QAAS,GAAI,GAAI,EAAG,QAC9C2H,iBAAiB7G,KAAK2C,WAAW,gCAChBQ,IAAlBnD,KAAKZ,gBACAA,SAASmH,UAAY,KAIlCrG,iBACW"}