define("mmogametype_quiz/mmogametypequizalone",["mmogametype_quiz/mmogametypequiz"],(function(MmoGameTypeQuiz){return class extends MmoGameTypeQuiz{player;constructor(){super(),this.cIcons=this.hasHelp()?5:4,this.type="alone"}createIconBar(){let i=0;const step=this.iconSize+this.padding,nicknameHeight=Math.round(this.iconSize/3);let nickname,avatar;[nickname,avatar]=this.createNicknameAvatar("mmogame-quiz-alone",Math.round(this.padding+i++*step),this.padding,2*this.iconSize+this.padding,nicknameHeight,this.padding+nicknameHeight,this.iconSize),this.player=this.createDivScorePercent("mmogame-quiz-alone",this.padding+i++*step,this.padding+nicknameHeight,this.getContrastingColor(this.color),!0),this.player.nicknameElement=nickname,this.player.avatarElement=avatar,this.createButtonSound(this.padding+i++*step,this.padding+nicknameHeight,this.iconSize),this.hasHelp()&&(this.createButtonHelp(this.padding+i++*step,this.padding),this.buttonHelp.addEventListener("click",(()=>this.onClickHelp(this.buttonHelp)))),this.createArea(2*this.padding+this.iconSize)}processSetAnswer(json){this.correct=json.correct,this.playAudio(0!==json.iscorrect?this.audioYes:this.audioNo),void 0!==json.correct&&"multichoice"===this.qtype&&this.updateScreenAfterAnswerMultichoice(),this.disableInput(),this.btnSubmit&&(this.body.removeChild(this.btnSubmit),this.btnSubmit=void 0);const btn=super.createImageButton(this.area,"mmogame-quiz-next",this.nextLeft,this.nextTop,0,this.iconSize,"assets/next.svg");btn.addEventListener("click",(()=>{this.callGetAttempt(),this.area.removeChild(btn)})),this.showScore(json)}onServerFastJson(response){const[state,timefastjson]=response.split("-").map(Number);timefastjson===this.timefastjson&&state===this.state?this.sendFastJSON():this.sendGetAttempt({mmogameid:this.mmogameid,kinduser:this.kinduser,user:this.user})}createScreen(json,disabled){if(this.endofgame)return this.createDivMessage("mmogame-endofgame",this.getStringM("js_game_over")),void this.showScore(json);this.vertical?this.createScreenVertical(disabled):this.createScreenHorizontal(json,disabled),this.showScore(json)}createScreenHorizontal(json,disabled){let maxHeight=this.areaRect.height-2*this.padding;this.hideSubmit||(maxHeight-=this.iconSize+this.padding);const width=Math.round((this.areaRect.width-this.padding)/2);for(let step=1;step<=2;step++){let defSize;if(this.fontSize=this.findbest(1===step?this.minFontSize:this.minFontSize/2,this.maxFontSize,(fontSize=>{if(defSize=this.createDefinition(0,0,width-this.padding,0,!0,fontSize,json.definition),defSize[0]>=width)return 1;let ansSize=this.createAnswer(0,0,width-this.padding,!0,fontSize,disabled);return ansSize[0]>=width?1:defSize[1]<maxHeight&&ansSize[1]<maxHeight?-1:1})),defSize[0]<=width&&defSize[1]<=this.areaRect.height)break}this.radioSize=Math.round(this.fontSize),this.createDefinition(0,0,width-this.padding,0,!1,this.fontSize,json.definition),this.nextTop=this.createAnswer(width,0,width-this.padding,!1,this.fontSize,disabled)+this.padding,this.hideSubmit||(this.btnSubmit=this.createImageButton(this.body,"mmogame-quiz-submit",width+(width-this.iconSize)/2,this.nextTop,0,this.iconSize,"assets/submit.svg",!1,"submit"),this.btnSubmit.addEventListener("click",(()=>{this.sendAnswer()}))),this.stripLeft=width+this.padding,this.stripWidth=2*this.iconSize,this.stripHeight=this.iconSize}processGetAttempt(json){if(this.computeDifClock(json.time,json.timestart,json.timeclose),0===parseInt(json.state))return json.qtype="",json.colors&&(this.setColorsString(json.colors),this.createIconBar()),this.showScore(json),void this.createDivMessageStart(this.getStringM("js_wait_to_start"));json.colors&&(this.setColorsString(json.colors),this.createIconBar()),json.name&&(document.title=json.name),json.errorcode?this.createDivMessage("mmogame-error",json.errorcode):(this.state=parseInt(json.state,10),this.fastjson=json.fastjson,this.timefastjson=parseInt(json.timefastjson,10),this.updateNicknameAvatar(this.player,json.avatar,json.nickname),this.attempt=json.attempt,this.qtype=json.qtype,"multichoice"===this.qtype&&(this.answers=[],this.answersID=json.answerids,json.answers.forEach(((answer,index)=>{this.answers[index]=this.repairP(answer)}))),this.answer=json.answer??void 0,this.endofgame=void 0!==json.endofgame&&0!==json.endofgame,json.definition=this.repairP(json.definition),this.errorcode=json.errorcode,0!==json.state&&this.createScreen(json,!1),this.sendFastJSON(),this.btnSubmit&&(this.btnSubmit.style.visibility="hidden"))}showScore(_ref){let{sumscore:sumscore,rank:rank,percent:percent,percentrank:percentrank}=_ref;super.showScore(this.player,sumscore,rank,percent,percentrank,!0)}showHelpScreen(div){div.innerHTML=`\n                <br>\n                <div>${this.getStringT("js_alone_help")}</div><br>\n\n                <table border=1>\n                    <tr>\n                        <td><img height="83" src="assets/aduel/example2.png" alt="" /></td>\n                        <td>${this.getStringT("js_aduel_example2")}</td>\n                    </tr>\n                </table>\n            `}}}));

//# sourceMappingURL=mmogametypequizalone.min.js.map